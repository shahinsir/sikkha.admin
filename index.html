<!DOCTYPE html>
<html lang="bn">
<head>
    <base href="./">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes">
    <meta name="theme-color" content="#4f46e5">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="শিক্ষা এডমিন">
    <meta name="description" content="শিক্ষা সহায়িকা কন্টেন্ট ম্যানেজমেন্ট সিস্টেম - পূর্ণাঙ্গ এডমিন অ্যাপ">
    <meta name="keywords" content="শিক্ষা, কন্টেন্ট, এডমিন, বাংলাদেশ, বই, গাইড, PWA">
    <title>শিক্ষা সহায়িকা এডমিন</title>
    
    <!-- PWA Manifest -->
    <link rel="manifest" href="manifest.json">
    
    <!-- Apple Touch Icons -->
    <link rel="apple-touch-icon" href="https://i.ibb.co/XGNQ8V4/icon-180x180.png">
    <link rel="apple-touch-icon" sizes="180x180" href="https://i.ibb.co/XGNQ8V4/icon-180x180.png">
    
    <!-- Favicon -->
    <link rel="icon" type="image/png" href="https://i.ibb.co/wFnz89n6/icon-192x192.png">
    
    <!-- Firebase -->
    <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-database-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-storage-compat.js"></script>
    
    <!-- Font Awesome for icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        :root {
            --primary: #4f46e5;
            --primary-dark: #4338ca;
            --primary-light: #e0e7ff;
            --secondary: #10b981;
            --secondary-dark: #059669;
            --secondary-light: #d1fae5;
            --danger: #ef4444;
            --danger-dark: #dc2626;
            --danger-light: #fee2e2;
            --warning: #f59e0b;
            --warning-dark: #d97706;
            --warning-light: #fef3c7;
            --info: #3b82f6;
            --info-dark: #2563eb;
            --info-light: #dbeafe;
            --dark: #1f2937;
            --dark-light: #374151;
            --light: #f9fafb;
            --gray: #6b7280;
            --gray-light: #e5e7eb;
            --gray-dark: #4b5563;
            --shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.1);
            --shadow-lg: 0 20px 40px -10px rgba(0, 0, 0, 0.15);
            --shadow-xl: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
            --radius: 16px;
            --radius-lg: 20px;
            --radius-xl: 24px;
            --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            --transition-slow: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Inter', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: var(--dark);
            min-height: 100vh;
            -webkit-tap-highlight-color: transparent;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            overflow-x: hidden;
            position: relative;
        }
        
        /* Animated background elements */
        .bg-shapes {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            overflow: hidden;
        }
        
        .shape {
            position: absolute;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.1);
            animation: float 20s infinite linear;
        }
        
        .shape-1 {
            width: 300px;
            height: 300px;
            top: 10%;
            left: 5%;
            animation-delay: 0s;
        }
        
        .shape-2 {
            width: 200px;
            height: 200px;
            top: 60%;
            right: 10%;
            animation-delay: 5s;
            animation-duration: 25s;
        }
        
        .shape-3 {
            width: 150px;
            height: 150px;
            bottom: 20%;
            left: 15%;
            animation-delay: 10s;
            animation-duration: 30s;
        }
        
        .shape-4 {
            width: 250px;
            height: 250px;
            top: 20%;
            right: 15%;
            animation-delay: 15s;
        }
        
        @keyframes float {
            0% {
                transform: translateY(0) rotate(0deg);
                opacity: 0.1;
            }
            25% {
                transform: translateY(-20px) rotate(90deg);
                opacity: 0.15;
            }
            50% {
                transform: translateY(0) rotate(180deg);
                opacity: 0.2;
            }
            75% {
                transform: translateY(20px) rotate(270deg);
                opacity: 0.15;
            }
            100% {
                transform: translateY(0) rotate(360deg);
                opacity: 0.1;
            }
        }
        
        /* Glassmorphism effect */
        .glass {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            box-shadow: var(--shadow-xl);
        }
        
        /* Login Modal */
        #loginModal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            z-index: 9999;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
            animation: fadeIn 0.5s ease;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        .login-container {
            background: rgba(255, 255, 255, 0.95);
            padding: 40px;
            border-radius: var(--radius-xl);
            max-width: 440px;
            width: 100%;
            text-align: center;
            box-shadow: var(--shadow-xl);
            animation: slideUp 0.6s cubic-bezier(0.34, 1.56, 0.64, 1);
            transform-origin: center;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            position: relative;
            overflow: hidden;
        }
        
        .login-container::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 5px;
            background: linear-gradient(90deg, var(--primary), var(--secondary), var(--warning));
            z-index: 1;
        }
        
        @keyframes slideUp {
            0% {
                transform: translateY(40px) scale(0.95);
                opacity: 0;
            }
            100% {
                transform: translateY(0) scale(1);
                opacity: 1;
            }
        }
        
        .login-header {
            margin-bottom: 32px;
            position: relative;
        }
        
        .login-logo {
            width: 80px;
            height: 80px;
            border-radius: 20px;
            margin: 0 auto 20px;
            background: linear-gradient(135deg, var(--primary), #7c3aed);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 36px;
            color: white;
            box-shadow: 0 10px 25px rgba(79, 70, 229, 0.3);
            animation: pulse 2s infinite;
            position: relative;
            overflow: hidden;
        }
        
        .login-logo::after {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: linear-gradient(45deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transform: rotate(45deg);
            animation: shine 3s infinite;
        }
        
        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }
        
        @keyframes shine {
            0% { transform: translateX(-100%) translateY(-100%) rotate(45deg); }
            100% { transform: translateX(100%) translateY(100%) rotate(45deg); }
        }
        
        .login-title {
            font-size: 28px;
            font-weight: 800;
            color: var(--dark);
            margin-bottom: 8px;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .login-subtitle {
            color: var(--gray);
            font-size: 14px;
            font-weight: 500;
        }
        
        .login-form-group {
            margin-bottom: 24px;
            text-align: left;
            position: relative;
        }
        
        .login-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--dark);
            font-size: 14px;
            display: flex;
            align-items: center;
            gap: 6px;
        }
        
        .login-input {
            width: 100%;
            padding: 16px 16px 16px 44px;
            border: 2px solid var(--gray-light);
            border-radius: 12px;
            font-size: 16px;
            transition: var(--transition);
            background: white;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
        }
        
        .login-input:focus {
            border-color: var(--primary);
            outline: none;
            box-shadow: 0 0 0 4px rgba(79, 70, 229, 0.1), 0 4px 6px rgba(0, 0, 0, 0.1);
            background: white;
        }
        
        .input-icon {
            position: absolute;
            left: 16px;
            top: 44px;
            color: var(--gray);
            font-size: 18px;
        }
        
        #loginError {
            background: var(--danger-light);
            color: var(--danger);
            padding: 16px;
            border-radius: 12px;
            margin-bottom: 24px;
            display: none;
            border: 2px solid var(--danger);
            animation: shake 0.5s ease;
            font-weight: 500;
        }
        
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }
        
        .login-btn {
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            color: white;
            border: none;
            width: 100%;
            padding: 18px;
            border-radius: 12px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            transition: var(--transition);
            position: relative;
            overflow: hidden;
            box-shadow: 0 8px 20px rgba(79, 70, 229, 0.3);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }
        
        .login-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 12px 25px rgba(79, 70, 229, 0.4);
        }
        
        .login-btn:active {
            transform: translateY(0);
        }
        
        .login-btn::after {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            transition: 0.5s;
        }
        
        .login-btn:hover::after {
            left: 100%;
        }
        
        /* Main App Container */
        .admin-container {
            max-width: 1200px;
            margin: 24px auto;
            background: rgba(255, 255, 255, 0.95);
            border-radius: var(--radius-xl);
            box-shadow: var(--shadow-xl);
            padding: 32px;
            display: none;
            animation: containerSlide 0.6s ease;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            position: relative;
            overflow: hidden;
        }
        
        .admin-container::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 5px;
            background: linear-gradient(90deg, var(--primary), var(--secondary), var(--warning));
            z-index: 1;
        }
        
        @keyframes containerSlide {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .app-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 32px;
            padding-bottom: 24px;
            border-bottom: 2px solid rgba(229, 231, 235, 0.5);
        }
        
        .header-left {
            display: flex;
            align-items: center;
            gap: 16px;
        }
        
        .app-logo {
            width: 56px;
            height: 56px;
            border-radius: 16px;
            background: linear-gradient(135deg, var(--primary), #7c3aed);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 28px;
            color: white;
            box-shadow: 0 8px 20px rgba(79, 70, 229, 0.3);
            position: relative;
            overflow: hidden;
        }
        
        .app-logo::after {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: linear-gradient(45deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transform: rotate(45deg);
            animation: shine 3s infinite;
        }
        
        .header-title h1 {
            font-size: 24px;
            font-weight: 800;
            color: var(--dark);
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .header-title p {
            font-size: 14px;
            color: var(--gray);
            margin-top: 4px;
            font-weight: 500;
        }
        
        .header-right {
            display: flex;
            align-items: center;
            gap: 16px;
        }
        
        .user-info {
            background: var(--primary-light);
            padding: 12px 20px;
            border-radius: 50px;
            color: var(--primary-dark);
            font-size: 14px;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 8px;
            border: 2px solid var(--primary);
            box-shadow: 0 4px 6px rgba(79, 70, 229, 0.1);
        }
        
        .logout-btn {
            background: linear-gradient(135deg, var(--danger), var(--danger-dark));
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 50px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 8px;
            box-shadow: 0 4px 6px rgba(239, 68, 68, 0.2);
        }
        
        .logout-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(239, 68, 68, 0.3);
        }
        
        /* Status Bar */
        .status-bar {
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.9), rgba(249, 250, 251, 0.9));
            padding: 20px 24px;
            border-radius: var(--radius-lg);
            margin-bottom: 32px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border: 1px solid rgba(229, 231, 235, 0.5);
            box-shadow: var(--shadow);
            animation: slideDown 0.4s ease;
            backdrop-filter: blur(5px);
        }
        
        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .status-left {
            display: flex;
            align-items: center;
            gap: 20px;
        }
        
        .status-item {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 8px 16px;
            background: rgba(255, 255, 255, 0.7);
            border-radius: 10px;
            border: 1px solid rgba(229, 231, 235, 0.5);
        }
        
        .status-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: var(--secondary);
            position: relative;
        }
        
        .status-dot::after {
            content: '';
            position: absolute;
            top: -3px;
            left: -3px;
            right: -3px;
            bottom: -3px;
            border-radius: 50%;
            border: 2px solid var(--secondary);
            animation: pulseDot 2s infinite;
        }
        
        .status-dot.offline {
            background: var(--danger);
        }
        
        .status-dot.offline::after {
            border-color: var(--danger);
        }
        
        @keyframes pulseDot {
            0% { transform: scale(0.8); opacity: 0.7; }
            70% { transform: scale(1.2); opacity: 0; }
            100% { transform: scale(0.8); opacity: 0; }
        }
        
        /* Tabs */
        .tabs {
            display: flex;
            gap: 8px;
            margin-bottom: 32px;
            background: rgba(255, 255, 255, 0.7);
            padding: 8px;
            border-radius: var(--radius-lg);
            border: 1px solid rgba(229, 231, 235, 0.5);
            backdrop-filter: blur(5px);
        }
        
        .tab {
            flex: 1;
            padding: 16px 24px;
            border: none;
            background: transparent;
            color: var(--gray);
            font-size: 15px;
            font-weight: 600;
            cursor: pointer;
            border-radius: 12px;
            transition: var(--transition);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }
        
        .tab:hover {
            background: rgba(79, 70, 229, 0.1);
            color: var(--primary);
            transform: translateY(-2px);
        }
        
        .tab.active {
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            color: white;
            box-shadow: var(--shadow);
        }
        
        /* Form Sections */
        .form-section {
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.95), rgba(249, 250, 251, 0.95));
            padding: 32px;
            border-radius: var(--radius-lg);
            margin-bottom: 32px;
            border: 1px solid rgba(229, 231, 235, 0.5);
            box-shadow: var(--shadow);
            animation: fadeInUp 0.5s ease;
            backdrop-filter: blur(5px);
        }
        
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .section-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 28px;
            padding-bottom: 16px;
            border-bottom: 2px solid rgba(229, 231, 235, 0.5);
        }
        
        .section-icon {
            width: 48px;
            height: 48px;
            border-radius: 12px;
            background: linear-gradient(135deg, var(--primary), #7c3aed);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            color: white;
            box-shadow: 0 8px 16px rgba(79, 70, 229, 0.3);
        }
        
        .section-title {
            font-size: 20px;
            font-weight: 800;
            color: var(--dark);
        }
        
        .section-subtitle {
            font-size: 14px;
            color: var(--gray);
            margin-top: 4px;
            font-weight: 500;
        }
        
        /* Grid Layout */
        .grid-2 {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 24px;
        }
        
        @media (max-width: 768px) {
            .grid-2 {
                grid-template-columns: 1fr;
            }
        }
        
        /* Form Groups */
        .form-group {
            margin-bottom: 24px;
            position: relative;
        }
        
        .form-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--dark);
            font-size: 14px;
            display: flex;
            align-items: center;
            gap: 6px;
        }
        
        .form-control {
            width: 100%;
            padding: 16px;
            border: 2px solid var(--gray-light);
            border-radius: 12px;
            font-size: 15px;
            transition: var(--transition);
            background: white;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
        }
        
        .form-control:focus {
            border-color: var(--primary);
            outline: none;
            box-shadow: 0 0 0 4px rgba(79, 70, 229, 0.1), 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        
        /* Buttons */
        .btn {
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            color: white;
            border: none;
            padding: 18px 32px;
            border-radius: 12px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            transition: var(--transition);
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            position: relative;
            overflow: hidden;
            box-shadow: 0 8px 20px rgba(79, 70, 229, 0.3);
        }
        
        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 12px 25px rgba(79, 70, 229, 0.4);
        }
        
        .btn:active {
            transform: translateY(0);
        }
        
        .btn-success {
            background: linear-gradient(135deg, var(--secondary), var(--secondary-dark));
            box-shadow: 0 8px 20px rgba(16, 185, 129, 0.3);
        }
        
        .btn-success:hover {
            box-shadow: 0 12px 25px rgba(16, 185, 129, 0.4);
        }
        
        /* Table Styles */
        .table-container {
            background: white;
            border-radius: var(--radius);
            overflow: hidden;
            box-shadow: var(--shadow);
            animation: fadeIn 0.5s ease;
            border: 1px solid rgba(229, 231, 235, 0.5);
        }
        
        .table {
            width: 100%;
            border-collapse: collapse;
        }
        
        .table th {
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            color: white;
            padding: 20px;
            text-align: left;
            font-weight: 600;
            font-size: 14px;
            border-bottom: 2px solid rgba(255, 255, 255, 0.2);
        }
        
        .table td {
            padding: 20px;
            border-bottom: 1px solid var(--gray-light);
            font-size: 14px;
        }
        
        .table tr:hover {
            background: rgba(79, 70, 229, 0.05);
        }
        
        .table tr:last-child td {
            border-bottom: none;
        }
        
        /* Badges */
        .badge {
            display: inline-block;
            padding: 6px 12px;
            border-radius: 50px;
            font-size: 12px;
            font-weight: 600;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }
        
        .badge-primary {
            background: rgba(79, 70, 229, 0.1);
            color: var(--primary);
            border: 1px solid rgba(79, 70, 229, 0.2);
        }
        
        .badge-success {
            background: rgba(16, 185, 129, 0.1);
            color: var(--secondary);
            border: 1px solid rgba(16, 185, 129, 0.2);
        }
        
        .badge-danger {
            background: rgba(239, 68, 68, 0.1);
            color: var(--danger);
            border: 1px solid rgba(239, 68, 68, 0.2);
        }
        
        .badge-warning {
            background: rgba(245, 158, 11, 0.1);
            color: var(--warning);
            border: 1px solid rgba(245, 158, 11, 0.2);
        }
        
        .badge-info {
            background: rgba(59, 130, 246, 0.1);
            color: var(--info);
            border: 1px solid rgba(59, 130, 246, 0.2);
        }
        
        /* Action Buttons */
        .action-group {
            display: flex;
            gap: 8px;
        }
        
        .action-btn {
            width: 40px;
            height: 40px;
            border-radius: 10px;
            border: none;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        
        .action-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.15);
        }
        
        .action-view {
            background: rgba(16, 185, 129, 0.1);
            color: var(--secondary);
            border: 1px solid rgba(16, 185, 129, 0.2);
        }
        
        .action-edit {
            background: rgba(245, 158, 11, 0.1);
            color: var(--warning);
            border: 1px solid rgba(245, 158, 11, 0.2);
        }
        
        .action-delete {
            background: rgba(239, 68, 68, 0.1);
            color: var(--danger);
            border: 1px solid rgba(239, 68, 68, 0.2);
        }
        
        /* Loading States */
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(79, 70, 229, 0.3);
            border-radius: 50%;
            border-top-color: var(--primary);
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        /* Toast Notifications */
        .toast-container {
            position: fixed;
            top: 24px;
            right: 24px;
            z-index: 9999;
        }
        
        .toast {
            background: white;
            padding: 20px 24px;
            border-radius: var(--radius);
            box-shadow: var(--shadow-lg);
            margin-bottom: 16px;
            display: flex;
            align-items: center;
            gap: 12px;
            animation: slideInRight 0.3s ease;
            min-width: 300px;
            border-left: 5px solid var(--primary);
            backdrop-filter: blur(5px);
            border: 1px solid rgba(229, 231, 235, 0.5);
        }
        
        @keyframes slideInRight {
            from {
                opacity: 0;
                transform: translateX(100px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }
        
        .toast.success {
            border-left-color: var(--secondary);
        }
        
        .toast.error {
            border-left-color: var(--danger);
        }
        
        .toast.warning {
            border-left-color: var(--warning);
        }
        
        .toast.info {
            border-left-color: var(--info);
        }
        
        /* Card Grid */
        .card-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 24px;
            margin-top: 24px;
        }
        
        .card {
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.95), rgba(249, 250, 251, 0.95));
            border-radius: var(--radius);
            padding: 24px;
            box-shadow: var(--shadow);
            transition: var(--transition);
            border: 1px solid rgba(229, 231, 235, 0.5);
            backdrop-filter: blur(5px);
        }
        
        .card:hover {
            transform: translateY(-4px);
            box-shadow: var(--shadow-lg);
            border-color: var(--primary);
        }
        
        /* Custom Delete Confirmation Modal */
        .delete-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            z-index: 10000;
            display: none;
            justify-content: center;
            align-items: center;
            padding: 20px;
            animation: fadeIn 0.3s ease;
            backdrop-filter: blur(5px);
        }
        
        .delete-content {
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.98), rgba(249, 250, 251, 0.98));
            border-radius: var(--radius-xl);
            max-width: 500px;
            width: 100%;
            overflow: hidden;
            box-shadow: var(--shadow-xl);
            animation: modalSlideUp 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            position: relative;
        }
        
        .delete-content::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 5px;
            background: linear-gradient(90deg, var(--danger), #f97316, var(--warning));
        }
        
        @keyframes modalSlideUp {
            from {
                opacity: 0;
                transform: translateY(60px) scale(0.95);
            }
            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }
        
        .delete-header {
            padding: 24px;
            border-bottom: 2px solid rgba(229, 231, 235, 0.5);
            display: flex;
            align-items: center;
            gap: 16px;
        }
        
        .delete-icon {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--danger-light), white);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 28px;
            color: var(--danger);
            border: 3px solid var(--danger);
            box-shadow: 0 8px 16px rgba(239, 68, 68, 0.2);
        }
        
        .delete-title {
            font-size: 22px;
            font-weight: 800;
            color: var(--danger);
            margin-bottom: 4px;
        }
        
        .delete-subtitle {
            font-size: 14px;
            color: var(--gray);
            font-weight: 500;
        }
        
        .delete-body {
            padding: 24px;
            border-bottom: 2px solid rgba(229, 231, 235, 0.5);
        }
        
        .delete-item-info {
            background: rgba(239, 68, 68, 0.05);
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 20px;
            border: 2px dashed rgba(239, 68, 68, 0.2);
        }
        
        .delete-item-title {
            font-size: 18px;
            font-weight: 700;
            color: var(--dark);
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .delete-item-details {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 12px;
            margin-top: 12px;
        }
        
        .delete-item-detail {
            display: flex;
            flex-direction: column;
            gap: 4px;
        }
        
        .delete-item-label {
            font-size: 12px;
            color: var(--gray);
            font-weight: 600;
        }
        
        .delete-item-value {
            font-size: 14px;
            font-weight: 600;
            color: var(--dark);
        }
        
        .delete-warning {
            background: rgba(245, 158, 11, 0.05);
            padding: 16px;
            border-radius: 12px;
            border: 2px solid rgba(245, 158, 11, 0.2);
            display: flex;
            align-items: flex-start;
            gap: 12px;
        }
        
        .warning-icon {
            color: var(--warning);
            font-size: 20px;
            margin-top: 2px;
        }
        
        .warning-text {
            color: var(--warning-dark);
            font-size: 14px;
            font-weight: 500;
            line-height: 1.5;
        }
        
        .delete-footer {
            padding: 24px;
            display: flex;
            justify-content: flex-end;
            gap: 16px;
        }
        
        .delete-cancel-btn {
            background: transparent;
            color: var(--gray);
            border: 2px solid var(--gray-light);
            padding: 14px 28px;
            border-radius: 12px;
            cursor: pointer;
            font-size: 15px;
            font-weight: 600;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .delete-cancel-btn:hover {
            background: var(--gray-light);
            transform: translateY(-2px);
        }
        
        .delete-confirm-btn {
            background: linear-gradient(135deg, var(--danger), var(--danger-dark));
            color: white;
            border: none;
            padding: 14px 28px;
            border-radius: 12px;
            cursor: pointer;
            font-size: 15px;
            font-weight: 600;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 8px;
            box-shadow: 0 8px 20px rgba(239, 68, 68, 0.3);
        }
        
        .delete-confirm-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 12px 25px rgba(239, 68, 68, 0.4);
        }
        
        .delete-confirm-btn:active {
            transform: translateY(0);
        }
        
        /* Responsive Design */
        @media (max-width: 768px) {
            .admin-container {
                padding: 20px;
                margin: 12px;
            }
            
            .app-header {
                flex-direction: column;
                gap: 16px;
                align-items: flex-start;
            }
            
            .header-right {
                width: 100%;
                justify-content: space-between;
            }
            
            .status-bar {
                flex-direction: column;
                gap: 16px;
                align-items: flex-start;
            }
            
            .tabs {
                flex-wrap: wrap;
            }
            
            .tab {
                min-width: calc(50% - 4px);
            }
            
            .table {
                display: block;
                overflow-x: auto;
            }
            
            .delete-footer {
                flex-direction: column;
            }
            
            .delete-cancel-btn,
            .delete-confirm-btn {
                width: 100%;
                justify-content: center;
            }
        }
        
        /* Custom Scrollbar */
        ::-webkit-scrollbar {
            width: 10px;
        }
        
        ::-webkit-scrollbar-track {
            background: var(--light);
            border-radius: 10px;
        }
        
        ::-webkit-scrollbar-thumb {
            background: var(--primary);
            border-radius: 10px;
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: var(--primary-dark);
        }
        
        /* File Upload Styles */
        .file-upload-area {
            border: 3px dashed var(--gray-light);
            border-radius: var(--radius-lg);
            padding: 48px 24px;
            text-align: center;
            cursor: pointer;
            transition: var(--transition);
            background: rgba(255, 255, 255, 0.7);
            margin-bottom: 24px;
            backdrop-filter: blur(5px);
        }
        
        .file-upload-area:hover {
            border-color: var(--primary);
            background: rgba(79, 70, 229, 0.05);
            transform: translateY(-2px);
        }
        
        .file-upload-area.dragover {
            border-color: var(--primary);
            background: rgba(79, 70, 229, 0.1);
            transform: scale(1.02);
        }
        
        .file-preview-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 16px;
            margin-top: 24px;
        }
        
        .file-preview-card {
            background: white;
            border-radius: 12px;
            padding: 16px;
            border: 2px solid var(--gray-light);
            transition: var(--transition);
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
        }
        
        .file-preview-card:hover {
            border-color: var(--primary);
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.1);
        }
        
        /* Progress Bar */
        .progress-container {
            background: var(--gray-light);
            border-radius: 10px;
            height: 10px;
            overflow: hidden;
            margin: 16px 0;
        }
        
        .progress-bar {
            height: 100%;
            background: linear-gradient(90deg, var(--primary), var(--secondary));
            width: 0%;
            transition: width 0.3s ease;
            border-radius: 10px;
            position: relative;
            overflow: hidden;
        }
        
        .progress-bar::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
            animation: progressShine 2s infinite;
        }
        
        @keyframes progressShine {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }
        
        /* Stats Cards */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 32px;
        }
        
        .stat-card {
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.95), rgba(249, 250, 251, 0.95));
            padding: 24px;
            border-radius: var(--radius);
            box-shadow: var(--shadow);
            transition: var(--transition);
            border: 1px solid rgba(229, 231, 235, 0.5);
            backdrop-filter: blur(5px);
        }
        
        .stat-card:hover {
            transform: translateY(-4px);
            box-shadow: var(--shadow-lg);
        }
        
        .stat-value {
            font-size: 32px;
            font-weight: 800;
            color: var(--primary);
            margin-bottom: 8px;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .stat-label {
            font-size: 14px;
            color: var(--gray);
            font-weight: 600;
        }
        
        /* Quick Actions */
        .quick-actions {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 16px;
            margin: 24px 0;
        }
        
        .quick-action-btn {
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.95), rgba(249, 250, 251, 0.95));
            border: 2px solid rgba(229, 231, 235, 0.5);
            padding: 20px;
            border-radius: var(--radius);
            text-align: center;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 12px;
            backdrop-filter: blur(5px);
        }
        
        .quick-action-btn:hover {
            border-color: var(--primary);
            transform: translateY(-4px);
            box-shadow: var(--shadow);
        }
        
        .quick-action-icon {
            width: 48px;
            height: 48px;
            border-radius: 12px;
            background: linear-gradient(135deg, var(--primary), #7c3aed);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            color: white;
            box-shadow: 0 8px 16px rgba(79, 70, 229, 0.3);
        }
        
        /* Empty State */
        .empty-state {
            text-align: center;
            padding: 64px 24px;
        }
        
        .empty-icon {
            width: 80px;
            height: 80px;
            margin: 0 auto 24px;
            background: rgba(255, 255, 255, 0.7);
            border-radius: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 32px;
            color: var(--gray);
            border: 2px dashed var(--gray-light);
        }
        
        /* Search and Filter */
        .search-container {
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.95), rgba(249, 250, 251, 0.95));
            padding: 20px;
            border-radius: var(--radius);
            margin-bottom: 24px;
            box-shadow: var(--shadow);
            display: flex;
            gap: 16px;
            flex-wrap: wrap;
            border: 1px solid rgba(229, 231, 235, 0.5);
            backdrop-filter: blur(5px);
        }
        
        .search-input {
            flex: 1;
            min-width: 200px;
            padding: 16px;
            border: 2px solid var(--gray-light);
            border-radius: 12px;
            font-size: 15px;
            transition: var(--transition);
            background: white;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
        }
        
        .search-input:focus {
            border-color: var(--primary);
            outline: none;
            box-shadow: 0 0 0 4px rgba(79, 70, 229, 0.1), 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        
        /* Modal Overlay */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            z-index: 10000;
            display: none;
            justify-content: center;
            align-items: center;
            padding: 20px;
            animation: fadeIn 0.3s ease;
            backdrop-filter: blur(5px);
        }
        
        .modal {
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.98), rgba(249, 250, 251, 0.98));
            border-radius: var(--radius-xl);
            max-width: 600px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: var(--shadow-xl);
            animation: modalSlideUp 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            position: relative;
        }
        
        .modal::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 5px;
            background: linear-gradient(90deg, var(--primary), var(--secondary), var(--warning));
        }
        
        .modal-header {
            padding: 24px;
            border-bottom: 2px solid rgba(229, 231, 235, 0.5);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .modal-title {
            font-size: 20px;
            font-weight: 800;
            color: var(--dark);
        }
        
        .modal-close {
            width: 40px;
            height: 40px;
            border-radius: 10px;
            border: none;
            background: var(--light);
            cursor: pointer;
            font-size: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: var(--transition);
            color: var(--gray);
        }
        
        .modal-close:hover {
            background: var(--danger);
            color: white;
            transform: rotate(90deg);
        }
        
        .modal-body {
            padding: 24px;
        }
        
        /* Floating Action Button */
        .fab {
            position: fixed;
            bottom: 32px;
            right: 32px;
            width: 64px;
            height: 64px;
            border-radius: 20px;
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            color: white;
            border: none;
            cursor: pointer;
            font-size: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 10px 30px rgba(79, 70, 229, 0.4);
            transition: var(--transition);
            z-index: 1000;
            animation: floatFab 3s infinite ease-in-out;
        }
        
        @keyframes floatFab {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }
        
        .fab:hover {
            transform: translateY(-4px) scale(1.1);
            box-shadow: 0 15px 40px rgba(79, 70, 229, 0.6);
            animation: none;
        }
        
        /* Dark Mode Support */
        @media (prefers-color-scheme: dark) {
            :root {
                --dark: #f9fafb;
                --light: #1f2937;
                --gray: #9ca3af;
                --gray-light: #374151;
                --gray-dark: #d1d5db;
            }
            
            body {
                background: linear-gradient(135deg, #1e3a8a 0%, #7c3aed 100%);
            }
            
            .glass,
            .login-container,
            .admin-container,
            .form-section,
            .table-container,
            .card,
            .modal,
            .search-container,
            .stat-card,
            .quick-action-btn,
            .status-bar,
            .tabs,
            .delete-content {
                background: rgba(17, 24, 39, 0.95);
                color: #f9fafb;
                border-color: rgba(55, 65, 81, 0.5);
            }
            
            .form-control,
            .login-input,
            .search-input {
                background: #1f2937;
                border-color: #374151;
                color: #f9fafb;
            }
            
            .table {
                background: #111827;
            }
            
            .table th {
                background: linear-gradient(135deg, #3730a3, #6d28d9);
            }
            
            .delete-content::before {
                background: linear-gradient(90deg, #dc2626, #ea580c, #d97706);
            }
            
            .delete-item-info {
                background: rgba(220, 38, 38, 0.1);
                border-color: rgba(220, 38, 38, 0.2);
            }
            
            .delete-warning {
                background: rgba(251, 191, 36, 0.1);
                border-color: rgba(251, 191, 36, 0.2);
            }
        }
    </style>
</head>
<body>
    <!-- Animated Background Shapes -->
    <div class="bg-shapes">
        <div class="shape shape-1"></div>
        <div class="shape shape-2"></div>
        <div class="shape shape-3"></div>
        <div class="shape shape-4"></div>
    </div>
    
    <!-- Login Modal -->
    <div id="loginModal">
        <div class="login-container">
            <div class="login-header">
                <div class="login-logo">
                    <i class="fas fa-book-open"></i>
                </div>
                <h1 class="login-title">শিক্ষা সহায়িকা এডমিন</h1>
                <p class="login-subtitle">শুধুমাত্র অনুমোদিত অ্যাডমিনদের জন্য</p>
            </div>
            
            <div id="loginError"></div>
            
            <div class="login-form-group">
                <label class="login-label">
                    <i class="fas fa-envelope"></i>
                    ইমেইল এড্রেস
                </label>
                <input type="email" id="adminEmail" class="login-input" placeholder="admin@example.com" autocomplete="email">
                <div class="input-icon">
                    <i class="fas fa-user"></i>
                </div>
            </div>
            
            <div class="login-form-group">
                <label class="login-label">
                    <i class="fas fa-lock"></i>
                    পাসওয়ার্ড
                </label>
                <input type="password" id="adminPassword" class="login-input" placeholder="••••••••" autocomplete="current-password">
                <div class="input-icon">
                    <i class="fas fa-key"></i>
                </div>
            </div>
            
            <button onclick="loginAdmin()" class="login-btn">
                <i class="fas fa-sign-in-alt"></i>
                লগইন করুন
            </button>
            
            <div style="margin-top: 32px; padding: 24px; background: rgba(79, 70, 229, 0.05); border-radius: 16px; border: 2px dashed rgba(79, 70, 229, 0.2);">
                <p style="color: var(--gray); font-size: 14px; line-height: 1.6;">
                    <i class="fas fa-lightbulb" style="color: var(--primary); margin-right: 8px;"></i>
                    টিপ: অ্যাপটি ইনস্টল করে হোম স্ক্রিন থেকে এক্সেস করুন। 
                    দ্রুত লোডিং, অফলাইন সাপোর্ট এবং নোটিফিকেশন পাবেন।
                </p>
            </div>
        </div>
    </div>
    
    <!-- Toast Container -->
    <div class="toast-container" id="toastContainer"></div>
    
    <!-- Delete Confirmation Modal -->
    <div class="delete-modal" id="deleteModal">
        <div class="delete-content" id="deleteContent">
            <!-- Delete content will be loaded here -->
        </div>
    </div>
    
    <!-- Main App Container -->
    <div class="admin-container" id="adminContainer">
        <!-- App Header -->
        <div class="app-header">
            <div class="header-left">
                <div class="app-logo">
                    <i class="fas fa-book-open"></i>
                </div>
                <div class="header-title">
                    <h1>শিক্ষা সহায়িকা এডমিন</h1>
                    <p>কন্টেন্ট ও ফাইল ম্যানেজমেন্ট সিস্টেম</p>
                </div>
            </div>
            <div class="header-right">
                <div class="user-info">
                    <i class="fas fa-user-circle"></i>
                    <span id="userEmail">admin@example.com</span>
                </div>
                <button onclick="logoutAdmin()" class="logout-btn">
                    <i class="fas fa-sign-out-alt"></i>
                    লগআউট
                </button>
            </div>
        </div>
        
        <!-- Status Bar -->
        <div class="status-bar">
            <div class="status-left">
                <div class="status-item">
                    <span class="status-dot" id="statusDot"></span>
                    <span id="statusText">অনলাইন</span>
                </div>
                <div class="status-item">
                    <i class="fas fa-database"></i>
                    <span>ডেটা: </span>
                    <span id="dataCount">0</span>
                </div>
                <div class="status-item">
                    <i class="fas fa-file"></i>
                    <span>ফাইল: </span>
                    <span id="fileCount">0</span>
                </div>
                <div class="status-item">
                    <i class="fas fa-clock"></i>
                    <span id="currentTime"></span>
                </div>
            </div>
            <div class="status-right">
                <span class="badge badge-primary" id="lastUpdate">আপডেট করা হয়নি</span>
            </div>
        </div>
        
        <!-- Quick Actions -->
        <div class="quick-actions">
            <div class="quick-action-btn" onclick="switchTab('contentTab')">
                <div class="quick-action-icon">
                    <i class="fas fa-plus"></i>
                </div>
                <span>কন্টেন্ট যুক্ত করুন</span>
            </div>
            <div class="quick-action-btn" onclick="switchTab('uploadTab')">
                <div class="quick-action-icon">
                    <i class="fas fa-upload"></i>
                </div>
                <span>ফাইল আপলোড</span>
            </div>
            <div class="quick-action-btn" onclick="switchTab('fileTab')">
                <div class="quick-action-icon">
                    <i class="fas fa-folder"></i>
                </div>
                <span>ফাইল ম্যানেজ</span>
            </div>
            <div class="quick-action-btn" onclick="showStats()">
                <div class="quick-action-icon">
                    <i class="fas fa-chart-bar"></i>
                </div>
                <span>স্ট্যাটিস্টিক্স</span>
            </div>
        </div>
        
        <!-- Tabs Navigation -->
        <div class="tabs">
            <button class="tab active" onclick="switchTab('contentTab')">
                <i class="fas fa-edit"></i> কন্টেন্ট
            </button>
            <button class="tab" onclick="switchTab('fileTab')">
                <i class="fas fa-folder"></i> ফাইল
            </button>
            <button class="tab" onclick="switchTab('uploadTab')">
                <i class="fas fa-upload"></i> আপলোড
            </button>
            <button class="tab" onclick="switchTab('settingsTab')">
                <i class="fas fa-cog"></i> সেটিংস
            </button>
        </div>
        
        <!-- Content Tab -->
        <div id="contentTab" class="tab-content active">
            <div class="form-section">
                <div class="section-header">
                    <div class="section-icon">
                        <i class="fas fa-plus"></i>
                    </div>
                    <div>
                        <h2 class="section-title">নতুন কন্টেন্ট যুক্ত করুন</h2>
                        <p class="section-subtitle">শিক্ষা উপকরণ, বই, গাইড, নোট এবং ভিডিও লিঙ্ক সংযুক্ত করুন</p>
                    </div>
                </div>
                
                <div class="grid-2">
                    <div class="form-group">
                        <label class="form-label">
                            <i class="fas fa-graduation-cap"></i>
                            ক্লাস নির্বাচন করুন
                        </label>
                        <select id="classSelect" class="form-control">
                            <option value="">-- ক্লাস সিলেক্ট করুন --</option>
                            <option value="Class 6">Class 6 - ষষ্ঠ শ্রেণী</option>
                            <option value="Class 7">Class 7 - সপ্তম শ্রেণী</option>
                            <option value="Class 8">Class 8 - অষ্টম শ্রেণী</option>
                            <option value="Class 9">Class 9 - নবম শ্রেণী</option>
                            <option value="Class 10">Class 10 - দশম শ্রেণী</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">
                            <i class="fas fa-book"></i>
                            বিষয় নির্বাচন করুন
                        </label>
                        <select id="subjectSelect" class="form-control">
                            <option value="">-- বিষয় সিলেক্ট করুন --</option>
                            <option value="math">গণিত (Mathematics)</option>
                            <option value="english">ইংরেজি (English)</option>
                            <option value="science">বিজ্ঞান (Science)</option>
                            <option value="ict">তথ্য ও যোগাযোগ প্রযুক্তি (ICT)</option>
                            <option value="agriculture">কৃষি শিক্ষা (Agriculture)</option>
                        </select>
                    </div>
                </div>
                
                <div class="grid-2">
                    <div class="form-group">
                        <label class="form-label">
                            <i class="fas fa-file-alt"></i>
                            কন্টেন্ট টাইপ
                        </label>
                        <select id="typeSelect" class="form-control">
                            <option value="বই">বই (Book)</option>
                            <option value="গাইড">গাইড (Guide)</option>
                            <option value="নোট">নোট (Note)</option>
                            <option value="ভিডিও">ভিডিও (Video)</option>
                            <option value="প্রশ্ন">প্রশ্ন (Question)</option>
                            <option value="পিডিএফ">পিডিএফ (PDF)</option>
                            <option value="ছবি">ছবি (Image)</option>
                            <option value="MCQ">MCQ</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">
                            <i class="fas fa-link"></i>
                            লিঙ্ক টাইপ
                        </label>
                        <select id="linkType" class="form-control">
                            <option value="drive">Google Drive</option>
                            <option value="youtube">YouTube</option>
                            <option value="pdf">PDF লিঙ্ক</option>
                            <option value="image">ছবি লিঙ্ক</option>
                            <option value="website">ওয়েবসাইট</option>
                        </select>
                    </div>
                </div>
                
                <div class="form-group">
                    <label class="form-label">
                        <i class="fas fa-heading"></i>
                        শিরোনাম (Title)
                    </label>
                    <input type="text" id="title" class="form-control" placeholder="যেমন: গণিত বই, ইংরেজি গ্রামার">
                </div>
                
                <div class="form-group">
                    <label class="form-label">
                        <i class="fas fa-align-left"></i>
                        বর্ণনা (Description)
                    </label>
                    <textarea id="description" class="form-control" rows="3" placeholder="বিস্তারিত বর্ণনা লিখুন..."></textarea>
                </div>
                
                <div class="form-group">
                    <label class="form-label">
                        <i class="fas fa-link"></i>
                        লিঙ্ক (Link)
                    </label>
                    <input type="text" id="link" class="form-control" placeholder="https://drive.google.com/file/d/XXXXX/view">
                    <small style="color: var(--gray); display: block; margin-top: 8px;">
                        <i class="fas fa-info-circle"></i> Google Drive, YouTube, PDF বা অন্য যেকোনো ফাইল লিঙ্ক দিন
                    </small>
                </div>
                
                <button onclick="addData()" class="btn btn-success" id="submitBtn" style="width: 100%;">
                    <i class="fas fa-save"></i> ডেটা সংরক্ষণ করুন
                </button>
            </div>
            
            <!-- Content List -->
            <div class="form-section">
                <div class="section-header">
                    <div class="section-icon">
                        <i class="fas fa-list"></i>
                    </div>
                    <div>
                        <h2 class="section-title">কন্টেন্ট তালিকা</h2>
                        <p class="section-subtitle">সকল আপলোডকৃত শিক্ষা উপকরণ</p>
                    </div>
                </div>
                
                <!-- Search and Filter -->
                <div class="search-container">
                    <input type="text" id="searchInput" class="search-input" placeholder="খুঁজুন...">
                    <select id="filterClass" class="form-control" style="min-width: 150px;">
                        <option value="">সব ক্লাস</option>
                        <option value="Class 6">Class 6</option>
                        <option value="Class 7">Class 7</option>
                        <option value="Class 8">Class 8</option>
                        <option value="Class 9">Class 9</option>
                        <option value="Class 10">Class 10</option>
                    </select>
                    <select id="filterSubject" class="form-control" style="min-width: 150px;">
                        <option value="">সব বিষয়</option>
                        <option value="math">গণিত</option>
                        <option value="english">ইংরেজি</option>
                        <option value="science">বিজ্ঞান</option>
                        <option value="ict">ICT</option>
                        <option value="agriculture">কৃষি</option>
                    </select>
                </div>
                
                <div id="loading" class="empty-state">
                    <div class="empty-icon">
                        <span class="loading"></span>
                    </div>
                    <p>ডেটা লোড হচ্ছে...</p>
                </div>
                
                <div id="dataDisplay"></div>
            </div>
        </div>
        
        <!-- File Tab -->
        <div id="fileTab" class="tab-content" style="display: none;">
            <div class="form-section">
                <div class="section-header">
                    <div class="section-icon">
                        <i class="fas fa-folder"></i>
                    </div>
                    <div>
                        <h2 class="section-title">ফাইল ম্যানেজমেন্ট</h2>
                        <p class="section-subtitle">সকল আপলোডকৃত ফাইল দেখুন এবং ব্যবস্থাপনা করুন</p>
                    </div>
                </div>
                
                <!-- Stats -->
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-value" id="totalFilesStat">0</div>
                        <div class="stat-label">মোট ফাইল</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="totalSizeStat">0 MB</div>
                        <div class="stat-label">মোট সাইজ</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="pdfFilesStat">0</div>
                        <div class="stat-label">PDF ফাইল</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="imageFilesStat">0</div>
                        <div class="stat-label">ছবি ফাইল</div>
                    </div>
                </div>
                
                <!-- File Search -->
                <div class="search-container">
                    <input type="text" id="fileSearch" class="search-input" placeholder="ফাইল খুঁজুন...">
                    <select id="fileTypeFilter" class="form-control" style="min-width: 150px;">
                        <option value="">সব টাইপ</option>
                        <option value="pdf">PDF</option>
                        <option value="image">ছবি</option>
                        <option value="video">ভিডিও</option>
                        <option value="document">ডকুমেন্ট</option>
                    </select>
                    <button onclick="refreshFiles()" class="btn" style="min-width: 120px;">
                        <i class="fas fa-sync-alt"></i> রিফ্রেশ
                    </button>
                </div>
                
                <div id="filesLoading" class="empty-state">
                    <div class="empty-icon">
                        <span class="loading"></span>
                    </div>
                    <p>ফাইল লোড হচ্ছে...</p>
                </div>
                
                <div id="filesDisplay"></div>
            </div>
        </div>
        
        <!-- Upload Tab -->
        <div id="uploadTab" class="tab-content" style="display: none;">
            <div class="form-section">
                <div class="section-header">
                    <div class="section-icon">
                        <i class="fas fa-upload"></i>
                    </div>
                    <div>
                        <h2 class="section-title">ফাইল আপলোড</h2>
                        <p class="section-subtitle">নতুন ফাইল আপলোড করুন এবং সংরক্ষণ করুন</p>
                    </div>
                </div>
                
                <!-- File Upload Area -->
                <div class="file-upload-area" id="dropArea" onclick="document.getElementById('fileInput').click()">
                    <div style="font-size: 64px; color: var(--primary); margin-bottom: 20px;">
                        <i class="fas fa-cloud-upload-alt"></i>
                    </div>
                    <h3 style="margin-bottom: 12px; color: var(--dark);">ফাইল নির্বাচন করুন</h3>
                    <p style="color: var(--gray); margin-bottom: 24px;">এখানে ক্লিক করুন বা ফাইল ড্রপ করুন</p>
                    <div style="background: rgba(79, 70, 229, 0.1); padding: 12px 24px; border-radius: 50px; display: inline-block;">
                        <span style="color: var(--primary); font-weight: 600;">সাপোর্টেড ফরম্যাট: PDF, Image, Video, Documents</span>
                    </div>
                    <p style="color: var(--gray); margin-top: 16px; font-size: 14px;">সর্বোচ্চ সাইজ: 50MB</p>
                </div>
                <input type="file" id="fileInput" multiple style="display: none;" onchange="handleFileSelect(event)">
                
                <!-- Progress Bar -->
                <div id="uploadProgress" style="display: none;">
                    <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                        <span>আপলোড হচ্ছে...</span>
                        <span id="progressPercent">0%</span>
                    </div>
                    <div class="progress-container">
                        <div class="progress-bar" id="progressBar"></div>
                    </div>
                </div>
                
                <!-- File Preview -->
                <div id="filePreview" class="file-preview-grid"></div>
                
                <!-- File Details Form -->
                <div class="grid-2" style="margin-top: 32px;">
                    <div class="form-group">
                        <label class="form-label">
                            <i class="fas fa-file-signature"></i>
                            ফাইলের নাম
                        </label>
                        <input type="text" id="fileName" class="form-control" placeholder="যেমন: গণিত বই, English Grammar">
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">
                            <i class="fas fa-file-alt"></i>
                            ফাইল টাইপ
                        </label>
                        <select id="fileType" class="form-control">
                            <option value="pdf">PDF ডকুমেন্ট</option>
                            <option value="image">ছবি (Image)</option>
                            <option value="video">ভিডিও (Video)</option>
                            <option value="document">ডকুমেন্ট</option>
                            <option value="other">অন্যান্য</option>
                        </select>
                    </div>
                </div>
                
                <div class="grid-2">
                    <div class="form-group">
                        <label class="form-label">
                            <i class="fas fa-graduation-cap"></i>
                            ক্লাস
                        </label>
                        <select id="fileClass" class="form-control">
                            <option value="">-- ক্লাস সিলেক্ট করুন --</option>
                            <option value="Class 6">Class 6 - ষষ্ঠ শ্রেণী</option>
                            <option value="Class 7">Class 7 - সপ্তম শ্রেণী</option>
                            <option value="Class 8">Class 8 - অষ্টম শ্রেণী</option>
                            <option value="Class 9">Class 9 - নবম শ্রেণী</option>
                            <option value="Class 10">Class 10 - দশম শ্রেণী</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">
                            <i class="fas fa-book"></i>
                            বিষয়
                        </label>
                        <select id="fileSubject" class="form-control">
                            <option value="">-- বিষয় সিলেক্ট করুন --</option>
                            <option value="math">গণিত (Mathematics)</option>
                            <option value="english">ইংরেজি (English)</option>
                            <option value="science">বিজ্ঞান (Science)</option>
                            <option value="ict">তথ্য ও যোগাযোগ প্রযুক্তি (ICT)</option>
                            <option value="agriculture">কৃষি শিক্ষা (Agriculture)</option>
                        </select>
                    </div>
                </div>
                
                <div class="form-group">
                    <label class="form-label">
                        <i class="fas fa-align-left"></i>
                        বর্ণনা (ঐচ্ছিক)
                    </label>
                    <textarea id="fileDescription" class="form-control" rows="3" placeholder="ফাইলের বিস্তারিত বর্ণনা লিখুন..."></textarea>
                </div>
                
                <div class="form-group">
                    <label class="form-label">
                        <i class="fas fa-tags"></i>
                        ট্যাগস (কমা দিয়ে আলাদা করুন)
                    </label>
                    <input type="text" id="fileTags" class="form-control" placeholder="যেমন: বই, গাইড, নোট, প্রশ্ন">
                </div>
                
                <button onclick="uploadFile()" class="btn btn-success" id="uploadBtn" style="width: 100%;">
                    <i class="fas fa-upload"></i> ফাইল আপলোড করুন
                </button>
            </div>
        </div>
        
        <!-- Settings Tab -->
        <div id="settingsTab" class="tab-content" style="display: none;">
            <div class="form-section">
                <div class="section-header">
                    <div class="section-icon">
                        <i class="fas fa-cog"></i>
                    </div>
                    <div>
                        <h2 class="section-title">সেটিংস</h2>
                        <p class="section-subtitle">অ্যাপের সেটিংস এবং কনফিগারেশন</p>
                    </div>
                </div>
                
                <div class="card-grid">
                    <div class="card" onclick="checkAppInstalled()">
                        <h3 style="margin-bottom: 12px;">
                            <i class="fas fa-mobile-alt"></i> PWA স্ট্যাটাস
                        </h3>
                        <p style="color: var(--gray); margin-bottom: 16px;">অ্যাপ ইনস্টলেশন স্ট্যাটাস চেক করুন</p>
                        <span class="badge badge-primary" id="pwaStatus">চেক করুন</span>
                    </div>
                    
                    <div class="card" onclick="clearCache()">
                        <h3 style="margin-bottom: 12px;">
                            <i class="fas fa-trash-alt"></i> ক্যাশে ক্লিয়ার
                        </h3>
                        <p style="color: var(--gray); margin-bottom: 16px;">অস্থায়ী ডেটা এবং ক্যাশে পরিষ্কার করুন</p>
                        <span class="badge badge-warning">ক্লিয়ার</span>
                    </div>
                    
                    <div class="card" onclick="exportData()">
                        <h3 style="margin-bottom: 12px;">
                            <i class="fas fa-file-export"></i> ডেটা এক্সপোর্ট
                        </h3>
                        <p style="color: var(--gray); margin-bottom: 16px;">সমস্ত ডেটা ব্যাকআপ করুন</p>
                        <span class="badge badge-success">এক্সপোর্ট</span>
                    </div>
                    
                    <div class="card" onclick="showAbout()">
                        <h3 style="margin-bottom: 12px;">
                            <i class="fas fa-info-circle"></i> সম্পর্কে
                        </h3>
                        <p style="color: var(--gray); margin-bottom: 16px;">অ্যাপ সম্পর্কে তথ্য</p>
                        <span class="badge badge-primary">দেখুন</span>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Modals -->
    <div class="modal-overlay" id="modalOverlay">
        <div class="modal" id="modalContent">
            <!-- Modal content will be loaded here -->
        </div>
    </div>
    
    <!-- Floating Action Button -->
    <button class="fab" id="fabButton" onclick="scrollToTop()">
        <i class="fas fa-arrow-up"></i>
    </button>

    <script>
        // ✅ Firebase Configuration
        const firebaseConfig = {
            apiKey: "AIzaSyB1vOW-DY6zIkXhPK5CRF3N8w-LzUKsvgg",
            authDomain: "education-app-8931d.firebaseapp.com",
            databaseURL: "https://education-app-8931d-default-rtdb.firebaseio.com",
            projectId: "education-app-8931d",
            storageBucket: "education-app-8931d.firebasestorage.app",
            messagingSenderId: "667995018685",
            appId: "1:667995018685:web:c8cdc1d432748cdc98eed4"
        };

        // ✅ Global Variables
        let db;
        let auth;
        let storage;
        let currentUser = null;
        let currentData = [];
        let currentFiles = [];
        let selectedFiles = [];
        let deferredPrompt = null;
        let isAppInstalled = false;
        let itemToDelete = null;
        let deleteType = null; // 'content' or 'file'

        // ✅ Performance Optimizations
        const debounce = (func, wait) => {
            let timeout;
            return function executedFunction(...args) {
                const later = () => {
                    clearTimeout(timeout);
                    func(...args);
                };
                clearTimeout(timeout);
                timeout = setTimeout(later, wait);
            };
        };

        // ✅ Initialize Firebase
        function initializeFirebase() {
            try {
                if (!firebase.apps.length) {
                    firebase.initializeApp(firebaseConfig);
                }
                db = firebase.database();
                auth = firebase.auth();
                storage = firebase.storage();
                console.log("✅ Firebase initialized successfully");
                setupAuth();
            } catch (error) {
                console.error("❌ Firebase initialization error:", error);
                showToast("Firebase সংযোগ ব্যর্থ", "error");
            }
        }

        // ✅ Authentication Setup
        function setupAuth() {
            auth.onAuthStateChanged((user) => {
                if (user) {
                    // User is signed in
                    currentUser = user;
                    document.getElementById('userEmail').textContent = user.email;
                    document.getElementById('loginModal').style.display = 'none';
                    document.getElementById('adminContainer').style.display = 'block';
                    
                    // Start real-time updates
                    startRealtimeUpdates();
                    
                    // Update status
                    showToast("লগইন সফল হয়েছে", "success");
                    
                    // Check PWA status
                    checkAppInstalled();
                    
                    // Update time
                    updateCurrentTime();
                    setInterval(updateCurrentTime, 60000);
                    
                    // Show FAB
                    document.getElementById('fabButton').style.display = 'flex';
                } else {
                    // User is signed out
                    currentUser = null;
                    document.getElementById('loginModal').style.display = 'flex';
                    document.getElementById('adminContainer').style.display = 'none';
                    document.getElementById('fabButton').style.display = 'none';
                }
            });
        }

        // ✅ Login Function
        function loginAdmin() {
            const email = document.getElementById('adminEmail').value.trim();
            const password = document.getElementById('adminPassword').value.trim();
            const errorDiv = document.getElementById('loginError');
            
            if (!email || !password) {
                showError("ইমেইল এবং পাসওয়ার্ড দিন");
                return;
            }
            
            errorDiv.style.display = 'none';
            showToast("লগইন হচ্ছে...", "info");
            
            auth.signInWithEmailAndPassword(email, password)
                .catch((error) => {
                    let errorMessage = "লগইন ব্যর্থ";
                    switch(error.code) {
                        case 'auth/invalid-email': errorMessage = "ভুল ইমেইল ফরম্যাট"; break;
                        case 'auth/user-disabled': errorMessage = "অ্যাকাউন্ট নিষ্ক্রিয়"; break;
                        case 'auth/user-not-found': errorMessage = "এই ইমেইলে অ্যাকাউন্ট নেই"; break;
                        case 'auth/wrong-password': errorMessage = "ভুল পাসওয়ার্ড"; break;
                        case 'auth/too-many-requests': errorMessage = "অনেকবার চেষ্টা করেছেন"; break;
                    }
                    showError(errorMessage);
                });
        }

        // ✅ Logout Function
        function logoutAdmin() {
            if (confirm("আপনি কি লগআউট করতে চান?")) {
                auth.signOut()
                    .then(() => {
                        showToast("লগআউট সফল", "info");
                    })
                    .catch((error) => {
                        console.error("Logout error:", error);
                    });
            }
        }

        // ✅ Tab Switching
        function switchTab(tabName) {
            // Hide all tabs
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.style.display = 'none';
            });
            
            // Remove active class from all tab buttons
            document.querySelectorAll('.tab').forEach(button => {
                button.classList.remove('active');
            });
            
            // Show selected tab
            document.getElementById(tabName).style.display = 'block';
            
            // Add active class to clicked button
            event.target.classList.add('active');
            
            // Load data if needed
            if (tabName === 'fileTab') {
                loadFiles();
            } else if (tabName === 'contentTab') {
                loadData();
            }
            
            // Smooth scroll to top
            scrollToTop();
        }

        // ✅ Start Real-time Updates
        function startRealtimeUpdates() {
            // Load data
            loadData();
            loadFiles();
            
            // Set up real-time listeners
            setupRealtimeListeners();
            
            // Update stats periodically
            setInterval(updateStats, 30000);
        }

        // ✅ Set up real-time database listeners
        function setupRealtimeListeners() {
            if (!db) return;
            
            // Listen for new data
            db.ref('materials').on('value', (snapshot) => {
                if (currentUser) {
                    loadData();
                }
            });
            
            // Listen for file changes
            db.ref('files').on('value', (snapshot) => {
                if (currentUser) {
                    loadFiles();
                }
            });
        }

        // ✅ Load Data
        function loadData() {
            if (!db) return;
            
            const loading = document.getElementById('loading');
            loading.style.display = 'block';
            
            db.ref('materials').orderByChild('timestamp').once('value')
                .then((snapshot) => {
                    loading.style.display = 'none';
                    
                    if (!snapshot.exists()) {
                        document.getElementById('dataDisplay').innerHTML = `
                            <div class="empty-state">
                                <div class="empty-icon">
                                    <i class="fas fa-inbox"></i>
                                </div>
                                <h3 style="margin-bottom: 12px;">কোনো কন্টেন্ট নেই</h3>
                                <p style="color: var(--gray);">এখনই প্রথম কন্টেন্ট যোগ করুন</p>
                            </div>
                        `;
                        updateCounts(0, 0);
                        return;
                    }
                    
                    currentData = [];
                    let html = `
                        <div class="table-container">
                            <table class="table">
                                <thead>
                                    <tr>
                                        <th>#</th>
                                        <th>শিরোনাম</th>
                                        <th>ক্লাস</th>
                                        <th>বিষয়</th>
                                        <th>টাইপ</th>
                                        <th>তারিখ</th>
                                        <th>অ্যাকশন</th>
                                    </tr>
                                </thead>
                                <tbody>`;
                    
                    let index = 1;
                    let linkCount = 0;
                    
                    snapshot.forEach((child) => {
                        const val = child.val();
                        const key = child.key;
                        
                        currentData.push({key, ...val});
                        if (val.link) linkCount++;
                        
                        html += `
                            <tr>
                                <td>${index}</td>
                                <td>
                                    <strong>${val.title || 'N/A'}</strong>
                                    ${val.description ? `<br><small style="color: var(--gray);">${val.description.substring(0, 50)}...</small>` : ''}
                                </td>
                                <td><span class="badge badge-primary">${val.class || 'N/A'}</span></td>
                                <td>${getSubjectName(val.subject || '')}</td>
                                <td><span class="badge badge-success">${val.type || 'N/A'}</span></td>
                                <td><small>${val.date || new Date(val.timestamp).toLocaleDateString('bn-BD')}</small></td>
                                <td>
                                    <div class="action-group">
                                        <button onclick="viewItem('${key}')" class="action-btn action-view" title="দেখুন">
                                            <i class="fas fa-eye"></i>
                                        </button>
                                        <button onclick="editItem('${key}')" class="action-btn action-edit" title="এডিট">
                                            <i class="fas fa-edit"></i>
                                        </button>
                                        <button onclick="showDeleteConfirmation('${key}', 'content')" class="action-btn action-delete" title="ডিলিট">
                                            <i class="fas fa-trash"></i>
                                        </button>
                                    </div>
                                </td>
                            </tr>`;
                        index++;
                    });
                    
                    html += `</tbody></table></div>`;
                    document.getElementById('dataDisplay').innerHTML = html;
                    updateCounts(index-1, linkCount);
                    
                    // Update last update time
                    document.getElementById('lastUpdate').textContent = `সর্বশেষ আপডেট: ${new Date().toLocaleTimeString('bn-BD', {hour: '2-digit', minute:'2-digit'})}`;
                    
                    // Setup search filter
                    setupSearchFilter();
                })
                .catch((error) => {
                    loading.style.display = 'none';
                    showToast("ডেটা লোড ব্যর্থ", "error");
                    console.error("Load data error:", error);
                });
        }

        // ✅ Improved Delete Confirmation
        function showDeleteConfirmation(key, type) {
            deleteType = type;
            
            if (type === 'content') {
                const item = currentData.find(d => d.key === key);
                if (!item) return;
                
                itemToDelete = {key, ...item};
                
                document.getElementById('deleteContent').innerHTML = `
                    <div class="delete-header">
                        <div class="delete-icon">
                            <i class="fas fa-exclamation-triangle"></i>
                        </div>
                        <div>
                            <h2 class="delete-title">কন্টেন্ট ডিলিট করুন</h2>
                            <p class="delete-subtitle">আপনি কি নিশ্চিত যে এই কন্টেন্টটি ডিলিট করতে চান?</p>
                        </div>
                    </div>
                    <div class="delete-body">
                        <div class="delete-item-info">
                            <div class="delete-item-title">
                                <i class="fas fa-file-alt"></i>
                                ${item.title || 'N/A'}
                            </div>
                            <div class="delete-item-details">
                                <div class="delete-item-detail">
                                    <span class="delete-item-label">ক্লাস</span>
                                    <span class="delete-item-value">${item.class || 'N/A'}</span>
                                </div>
                                <div class="delete-item-detail">
                                    <span class="delete-item-label">বিষয়</span>
                                    <span class="delete-item-value">${getSubjectName(item.subject || '')}</span>
                                </div>
                                <div class="delete-item-detail">
                                    <span class="delete-item-label">টাইপ</span>
                                    <span class="delete-item-value">${item.type || 'N/A'}</span>
                                </div>
                                <div class="delete-item-detail">
                                    <span class="delete-item-label">তারিখ</span>
                                    <span class="delete-item-value">${item.date || new Date(item.timestamp).toLocaleDateString('bn-BD')}</span>
                                </div>
                            </div>
                        </div>
                        <div class="delete-warning">
                            <div class="warning-icon">
                                <i class="fas fa-exclamation-circle"></i>
                            </div>
                            <div class="warning-text">
                                এই কন্টেন্টটি ডিলিট করা হলে এটি চিরতরে মুছে যাবে এবং ফিরিয়ে আনা সম্ভব হবে না।
                            </div>
                        </div>
                    </div>
                    <div class="delete-footer">
                        <button onclick="closeDeleteModal()" class="delete-cancel-btn">
                            <i class="fas fa-times"></i> বাতিল করুন
                        </button>
                        <button onclick="confirmDelete()" class="delete-confirm-btn">
                            <i class="fas fa-trash"></i> ডিলিট করুন
                        </button>
                    </div>
                `;
            } else if (type === 'file') {
                const file = currentFiles.find(f => f.key === key);
                if (!file) return;
                
                itemToDelete = {key, ...file};
                
                document.getElementById('deleteContent').innerHTML = `
                    <div class="delete-header">
                        <div class="delete-icon">
                            <i class="fas fa-exclamation-triangle"></i>
                        </div>
                        <div>
                            <h2 class="delete-title">ফাইল ডিলিট করুন</h2>
                            <p class="delete-subtitle">আপনি কি নিশ্চিত যে এই ফাইলটি ডিলিট করতে চান?</p>
                        </div>
                    </div>
                    <div class="delete-body">
                        <div class="delete-item-info">
                            <div class="delete-item-title">
                                <i class="fas fa-file"></i>
                                ${file.fileName}
                            </div>
                            <div class="delete-item-details">
                                <div class="delete-item-detail">
                                    <span class="delete-item-label">ক্লাস</span>
                                    <span class="delete-item-value">${file.class || 'N/A'}</span>
                                </div>
                                <div class="delete-item-detail">
                                    <span class="delete-item-label">বিষয়</span>
                                    <span class="delete-item-value">${getSubjectName(file.subject || '')}</span>
                                </div>
                                <div class="delete-item-detail">
                                    <span class="delete-item-label">সাইজ</span>
                                    <span class="delete-item-value">${formatFileSize(file.size || 0)}</span>
                                </div>
                                <div class="delete-item-detail">
                                    <span class="delete-item-label">তারিখ</span>
                                    <span class="delete-item-value">${file.uploadDate || 'N/A'}</span>
                                </div>
                            </div>
                        </div>
                        <div class="delete-warning">
                            <div class="warning-icon">
                                <i class="fas fa-exclamation-circle"></i>
                            </div>
                            <div class="warning-text">
                                এই ফাইলটি ডিলিট করা হলে এটি ডাটাবেস এবং স্টোরেজ থেকে চিরতরে মুছে যাবে এবং ফিরিয়ে আনা সম্ভব হবে না।
                            </div>
                        </div>
                    </div>
                    <div class="delete-footer">
                        <button onclick="closeDeleteModal()" class="delete-cancel-btn">
                            <i class="fas fa-times"></i> বাতিল করুন
                        </button>
                        <button onclick="confirmDelete()" class="delete-confirm-btn">
                            <i class="fas fa-trash"></i> ডিলিট করুন
                        </button>
                    </div>
                `;
            }
            
            document.getElementById('deleteModal').style.display = 'flex';
        }

        // ✅ Confirm Delete
        function confirmDelete() {
            if (!itemToDelete || !deleteType) return;
            
            if (deleteType === 'content') {
                db.ref('materials/' + itemToDelete.key).remove()
                    .then(() => {
                        showToast("কন্টেন্ট ডিলিট করা হয়েছে", "success");
                        closeDeleteModal();
                        loadData();
                    })
                    .catch((error) => {
                        showToast("ডিলিট ব্যর্থ: " + error.message, "error");
                        closeDeleteModal();
                    });
            } else if (deleteType === 'file') {
                const storageRef = storage.ref(itemToDelete.storagePath);
                storageRef.delete().then(() => {
                    db.ref('files/' + itemToDelete.key).remove()
                        .then(() => {
                            showToast("ফাইল ডিলিট হয়েছে", "success");
                            closeDeleteModal();
                            loadFiles();
                        })
                        .catch((error) => {
                            showToast("ডিলিট ব্যর্থ: " + error.message, "error");
                            closeDeleteModal();
                        });
                }).catch((error) => {
                    showToast("স্টোরেজ থেকে ডিলিট ব্যর্থ: " + error.message, "error");
                    closeDeleteModal();
                });
            }
            
            // Reset
            itemToDelete = null;
            deleteType = null;
        }

        // ✅ Close Delete Modal
        function closeDeleteModal() {
            document.getElementById('deleteModal').style.display = 'none';
            itemToDelete = null;
            deleteType = null;
        }

        // ✅ Setup Search and Filter
        function setupSearchFilter() {
            const searchInput = document.getElementById('searchInput');
            const filterClass = document.getElementById('filterClass');
            const filterSubject = document.getElementById('filterSubject');
            
            const filterData = () => {
                const searchTerm = searchInput.value.toLowerCase();
                const classFilter = filterClass.value;
                const subjectFilter = filterSubject.value;
                
                const filteredData = currentData.filter(item => {
                    const matchesSearch = !searchTerm || 
                        (item.title && item.title.toLowerCase().includes(searchTerm)) ||
                        (item.description && item.description.toLowerCase().includes(searchTerm));
                    
                    const matchesClass = !classFilter || item.class === classFilter;
                    const matchesSubject = !subjectFilter || item.subject === subjectFilter;
                    
                    return matchesSearch && matchesClass && matchesSubject;
                });
                
                renderFilteredData(filteredData);
            };
            
            searchInput.addEventListener('input', debounce(filterData, 300));
            filterClass.addEventListener('change', filterData);
            filterSubject.addEventListener('change', filterData);
        }

        // ✅ Render filtered data
        function renderFilteredData(filteredData) {
            if (filteredData.length === 0) {
                document.getElementById('dataDisplay').innerHTML = `
                    <div class="empty-state">
                        <div class="empty-icon">
                            <i class="fas fa-search"></i>
                        </div>
                        <h3 style="margin-bottom: 12px;">কোনো ফলাফল নেই</h3>
                        <p style="color: var(--gray);">অনুযায়ী কোনো কন্টেন্ট পাওয়া যায়নি</p>
                    </div>
                `;
                return;
            }
            
            let html = `
                <div class="table-container">
                    <table class="table">
                        <thead>
                            <tr>
                                <th>#</th>
                                <th>শিরোনাম</th>
                                <th>ক্লাস</th>
                                <th>বিষয়</th>
                                <th>টাইপ</th>
                                <th>তারিখ</th>
                                <th>অ্যাকশন</th>
                            </tr>
                        </thead>
                        <tbody>`;
            
            filteredData.forEach((item, index) => {
                html += `
                    <tr>
                        <td>${index + 1}</td>
                        <td>
                            <strong>${item.title || 'N/A'}</strong>
                            ${item.description ? `<br><small style="color: var(--gray);">${item.description.substring(0, 50)}...</small>` : ''}
                        </td>
                        <td><span class="badge badge-primary">${item.class || 'N/A'}</span></td>
                        <td>${getSubjectName(item.subject || '')}</td>
                        <td><span class="badge badge-success">${item.type || 'N/A'}</span></td>
                        <td><small>${item.date || new Date(item.timestamp).toLocaleDateString('bn-BD')}</small></td>
                        <td>
                            <div class="action-group">
                                <button onclick="viewItem('${item.key}')" class="action-btn action-view" title="দেখুন">
                                    <i class="fas fa-eye"></i>
                                </button>
                                <button onclick="editItem('${item.key}')" class="action-btn action-edit" title="এডিট">
                                    <i class="fas fa-edit"></i>
                                </button>
                                <button onclick="showDeleteConfirmation('${item.key}', 'content')" class="action-btn action-delete" title="ডিলিট">
                                    <i class="fas fa-trash"></i>
                                </button>
                            </div>
                        </td>
                    </tr>`;
            });
            
            html += `</tbody></table></div>`;
            document.getElementById('dataDisplay').innerHTML = html;
        }

        // ✅ Add Data (same as before, just updated to use new delete function)
        function addData() {
            if (!db || !currentUser) {
                showToast("সংযোগ নেই বা লগইন করুন", "error");
                return;
            }

            const cls = document.getElementById('classSelect').value;
            const subject = document.getElementById('subjectSelect').value;
            const type = document.getElementById('typeSelect').value;
            const title = document.getElementById('title').value.trim();
            const description = document.getElementById('description').value.trim();
            const link = document.getElementById('link').value.trim();
            const linkType = document.getElementById('linkType').value;

            if (!cls || !subject || !type || !title) {
                showToast("ক্লাস, বিষয়, টাইপ এবং শিরোনাম পূরণ করুন", "error");
                return;
            }

            let formattedLink = link;
            if (link && !link.startsWith('http')) {
                formattedLink = 'https://' + link;
            }

            const timestamp = Date.now();
            const newRef = db.ref('materials').push();
            
            const data = {
                class: cls,
                subject: subject,
                type: type,
                title: title,
                description: description,
                link: formattedLink || null,
                linkType: linkType,
                timestamp: timestamp,
                date: new Date().toLocaleString('bn-BD'),
                addedBy: currentUser.email,
                status: 'active'
            };
            
            const submitBtn = document.getElementById('submitBtn');
            const originalText = submitBtn.innerHTML;
            submitBtn.innerHTML = '<span class="loading"></span> সংরক্ষণ হচ্ছে...';
            submitBtn.disabled = true;
            
            newRef.set(data)
                .then(() => {
                    showToast("কন্টেন্ট সংরক্ষণ করা হয়েছে!", "success");
                    
                    // Clear form
                    document.getElementById('title').value = "";
                    document.getElementById('description').value = "";
                    document.getElementById('link').value = "";
                    
                    // Reset button
                    submitBtn.innerHTML = originalText;
                    submitBtn.disabled = false;
                    
                    // Reload data
                    loadData();
                })
                .catch((error) => {
                    showToast("সংরক্ষণ ব্যর্থ: " + error.message, "error");
                    submitBtn.innerHTML = originalText;
                    submitBtn.disabled = false;
                    console.error("Add data error:", error);
                });
        }

        // ✅ View Item (same as before)
        function viewItem(key) {
            const item = currentData.find(d => d.key === key);
            if (!item) return;
            
            openModal(`
                <div class="modal-header">
                    <h2 class="modal-title">${item.title}</h2>
                    <button onclick="closeModal()" class="modal-close">×</button>
                </div>
                <div class="modal-body">
                    <div style="margin-bottom: 24px;">
                        <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 16px; margin-bottom: 20px;">
                            <div>
                                <small style="color: var(--gray);">ক্লাস</small>
                                <div><span class="badge badge-primary">${item.class}</span></div>
                            </div>
                            <div>
                                <small style="color: var(--gray);">বিষয়</small>
                                <div>${getSubjectName(item.subject)}</div>
                            </div>
                            <div>
                                <small style="color: var(--gray);">টাইপ</small>
                                <div><span class="badge badge-success">${item.type}</span></div>
                            </div>
                            <div>
                                <small style="color: var(--gray);">তারিখ</small>
                                <div>${item.date || new Date(item.timestamp).toLocaleString('bn-BD')}</div>
                            </div>
                        </div>
                        ${item.description ? `
                        <div>
                            <small style="color: var(--gray);">বর্ণনা</small>
                            <div style="margin-top: 8px; padding: 16px; background: rgba(0,0,0,0.02); border-radius: 12px;">
                                ${item.description}
                            </div>
                        </div>` : ''}
                    </div>
                    ${item.link ? `
                    <div>
                        <small style="color: var(--gray);">লিঙ্ক</small>
                        <div style="margin-top: 8px;">
                            <a href="${item.link}" target="_blank" style="color: var(--primary); text-decoration: none; word-break: break-all;">
                                ${item.link}
                            </a>
                        </div>
                        <button onclick="window.open('${item.link}', '_blank')" class="btn" style="margin-top: 16px; width: 100%;">
                            <i class="fas fa-external-link-alt"></i> লিঙ্ক ওপেন করুন
                        </button>
                    </div>` : ''}
                </div>
            `);
        }

        // ✅ Edit Item (same as before)
        function editItem(key) {
            const item = currentData.find(d => d.key === key);
            if (!item) return;
            
            openModal(`
                <div class="modal-header">
                    <h2 class="modal-title">এডিট কন্টেন্ট</h2>
                    <button onclick="closeModal()" class="modal-close">×</button>
                </div>
                <div class="modal-body">
                    <div style="display: grid; gap: 20px;">
                        <div class="grid-2">
                            <div class="form-group">
                                <label class="form-label">ক্লাস</label>
                                <select id="editClass" class="form-control">
                                    <option value="Class 6" ${item.class === 'Class 6' ? 'selected' : ''}>Class 6</option>
                                    <option value="Class 7" ${item.class === 'Class 7' ? 'selected' : ''}>Class 7</option>
                                    <option value="Class 8" ${item.class === 'Class 8' ? 'selected' : ''}>Class 8</option>
                                    <option value="Class 9" ${item.class === 'Class 9' ? 'selected' : ''}>Class 9</option>
                                    <option value="Class 10" ${item.class === 'Class 10' ? 'selected' : ''}>Class 10</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label class="form-label">বিষয়</label>
                                <select id="editSubject" class="form-control">
                                    <option value="math" ${item.subject === 'math' ? 'selected' : ''}>গণিত</option>
                                    <option value="english" ${item.subject === 'english' ? 'selected' : ''}>ইংরেজি</option>
                                    <option value="science" ${item.subject === 'science' ? 'selected' : ''}>বিজ্ঞান</option>
                                    <option value="ict" ${item.subject === 'ict' ? 'selected' : ''}>ICT</option>
                                    <option value="agriculture" ${item.subject === 'agriculture' ? 'selected' : ''}>কৃষি</option>
                                </select>
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="form-label">শিরোনাম</label>
                            <input type="text" id="editTitle" class="form-control" value="${item.title || ''}">
                        </div>
                        <div class="form-group">
                            <label class="form-label">বর্ণনা</label>
                            <textarea id="editDescription" class="form-control" rows="3">${item.description || ''}</textarea>
                        </div>
                        <div class="form-group">
                            <label class="form-label">লিঙ্ক</label>
                            <input type="text" id="editLink" class="form-control" value="${item.link || ''}">
                        </div>
                        <div class="form-group">
                            <label class="form-label">টাইপ</label>
                            <select id="editType" class="form-control">
                                <option value="বই" ${item.type === 'বই' ? 'selected' : ''}>বই</option>
                                <option value="গাইড" ${item.type === 'গাইড' ? 'selected' : ''}>গাইড</option>
                                <option value="নোট" ${item.type === 'নোট' ? 'selected' : ''}>নোট</option>
                                <option value="ভিডিও" ${item.type === 'ভিডিও' ? 'selected' : ''}>ভিডিও</option>
                                <option value="প্রশ্ন" ${item.type === 'প্রশ্ন' ? 'selected' : ''}>প্রশ্ন</option>
                            </select>
                        </div>
                        <button onclick="updateItem('${key}')" class="btn btn-success">
                            <i class="fas fa-save"></i> আপডেট করুন
                        </button>
                    </div>
                </div>
            `);
        }

        // ✅ Update Item (same as before)
        function updateItem(key) {
            const cls = document.getElementById('editClass').value;
            const subject = document.getElementById('editSubject').value;
            const title = document.getElementById('editTitle').value.trim();
            const description = document.getElementById('editDescription').value.trim();
            const link = document.getElementById('editLink').value.trim();
            const type = document.getElementById('editType').value;

            if (!cls || !subject || !title) {
                showToast("সব প্রয়োজনীয় তথ্য পূরণ করুন", "error");
                return;
            }

            const updates = {
                class: cls,
                subject: subject,
                title: title,
                description: description,
                link: link || null,
                type: type,
                updatedAt: Date.now(),
                updatedBy: currentUser.email
            };

            db.ref('materials/' + key).update(updates)
                .then(() => {
                    showToast("কন্টেন্ট আপডেট করা হয়েছে!", "success");
                    closeModal();
                    loadData();
                })
                .catch((error) => {
                    showToast("আপডেট ব্যর্থ: " + error.message, "error");
                });
        }

        // ✅ File Upload Functions (updated to use new delete function)
        function handleFileSelect(event) {
            selectedFiles = Array.from(event.target.files);
            displayFilePreview();
        }

        function displayFilePreview() {
            const previewDiv = document.getElementById('filePreview');
            previewDiv.innerHTML = '';
            
            selectedFiles.forEach((file, index) => {
                const fileSize = formatFileSize(file.size);
                const fileType = file.type.split('/')[0];
                
                const card = document.createElement('div');
                card.className = 'file-preview-card';
                card.innerHTML = `
                    <div style="display: flex; align-items: center; gap: 12px;">
                        <div style="font-size: 32px; color: var(--primary);">
                            ${getFileIcon(file.type)}
                        </div>
                        <div style="flex: 1;">
                            <div style="font-weight: 600; margin-bottom: 4px; font-size: 14px;">${file.name}</div>
                            <div style="font-size: 12px; color: var(--gray);">${fileSize} • ${fileType}</div>
                        </div>
                        <button onclick="removeFile(${index})" style="background: none; border: none; color: var(--danger); cursor: pointer; font-size: 20px;">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                `;
                
                previewDiv.appendChild(card);
            });
            
            if (selectedFiles.length > 0) {
                document.getElementById('fileName').value = selectedFiles[0].name.split('.')[0];
            }
        }

        function getFileIcon(mimeType) {
            if (mimeType.includes('pdf')) return '<i class="fas fa-file-pdf"></i>';
            if (mimeType.includes('image')) return '<i class="fas fa-file-image"></i>';
            if (mimeType.includes('video')) return '<i class="fas fa-file-video"></i>';
            if (mimeType.includes('audio')) return '<i class="fas fa-file-audio"></i>';
            if (mimeType.includes('text') || mimeType.includes('document')) return '<i class="fas fa-file-alt"></i>';
            if (mimeType.includes('zip') || mimeType.includes('compressed')) return '<i class="fas fa-file-archive"></i>';
            return '<i class="fas fa-file"></i>';
        }

        function removeFile(index) {
            selectedFiles.splice(index, 1);
            displayFilePreview();
        }

        function formatFileSize(bytes) {
            if (bytes === 0) return '0 Bytes';
            const k = 1024;
            const sizes = ['Bytes', 'KB', 'MB', 'GB'];
            const i = Math.floor(Math.log(bytes) / Math.log(k));
            return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
        }

        // ✅ Upload File (same as before)
        function uploadFile() {
            if (!selectedFiles.length) {
                showToast("দয়া করে একটি ফাইল নির্বাচন করুন", "error");
                return;
            }
            
            const fileName = document.getElementById('fileName').value.trim();
            const fileDescription = document.getElementById('fileDescription').value.trim();
            const fileClass = document.getElementById('fileClass').value;
            const fileSubject = document.getElementById('fileSubject').value;
            const fileType = document.getElementById('fileType').value;
            const fileTags = document.getElementById('fileTags').value;
            
            if (!fileName || !fileClass || !fileSubject) {
                showToast("ফাইলের নাম, ক্লাস এবং বিষয় পূরণ করুন", "error");
                return;
            }
            
            const file = selectedFiles[0];
            const maxSize = 50 * 1024 * 1024;
            
            if (file.size > maxSize) {
                showToast("ফাইল সাইজ 50MB এর কম হতে হবে", "error");
                return;
            }
            
            // Show progress
            const progressDiv = document.getElementById('uploadProgress');
            const progressBar = document.getElementById('progressBar');
            const progressPercent = document.getElementById('progressPercent');
            const uploadBtn = document.getElementById('uploadBtn');
            
            progressDiv.style.display = 'block';
            uploadBtn.disabled = true;
            uploadBtn.innerHTML = '<span class="loading"></span> আপলোড হচ্ছে...';
            
            // Upload file
            const timestamp = Date.now();
            const fileExt = file.name.split('.').pop();
            const uniqueFileName = `${timestamp}_${Math.random().toString(36).substr(2, 9)}.${fileExt}`;
            const storageRef = storage.ref(`files/${uniqueFileName}`);
            
            const uploadTask = storageRef.put(file);
            
            uploadTask.on('state_changed',
                (snapshot) => {
                    const progress = (snapshot.bytesTransferred / snapshot.totalBytes) * 100;
                    progressBar.style.width = progress + '%';
                    progressPercent.textContent = Math.round(progress) + '%';
                },
                (error) => {
                    showToast("আপলোড ব্যর্থ: " + error.message, "error");
                    progressDiv.style.display = 'none';
                    uploadBtn.disabled = false;
                    uploadBtn.innerHTML = '<i class="fas fa-upload"></i> ফাইল আপলোড করুন';
                },
                () => {
                    uploadTask.snapshot.ref.getDownloadURL().then((downloadURL) => {
                        const fileData = {
                            originalName: file.name,
                            fileName: fileName,
                            description: fileDescription,
                            class: fileClass,
                            subject: fileSubject,
                            type: fileType,
                            tags: fileTags.split(',').map(tag => tag.trim()).filter(tag => tag),
                            size: file.size,
                            url: downloadURL,
                            storagePath: `files/${uniqueFileName}`,
                            uploadDate: new Date().toLocaleString('bn-BD'),
                            timestamp: timestamp,
                            uploadedBy: currentUser.email,
                            mimeType: file.type,
                            downloadCount: 0,
                            viewCount: 0,
                            status: 'active'
                        };
                        
                        db.ref('files').push(fileData)
                            .then(() => {
                                showToast("ফাইল সফলভাবে আপলোড হয়েছে!", "success");
                                
                                // Reset form
                                document.getElementById('fileName').value = '';
                                document.getElementById('fileDescription').value = '';
                                document.getElementById('fileClass').value = '';
                                document.getElementById('fileSubject').value = '';
                                document.getElementById('fileTags').value = '';
                                document.getElementById('filePreview').innerHTML = '';
                                selectedFiles = [];
                                document.getElementById('fileInput').value = '';
                                progressDiv.style.display = 'none';
                                uploadBtn.disabled = false;
                                uploadBtn.innerHTML = '<i class="fas fa-upload"></i> ফাইল আপলোড করুন';
                                
                                // Load files list
                                loadFiles();
                            })
                            .catch((error) => {
                                showToast("ডেটা সেভ ব্যর্থ: " + error.message, "error");
                                progressDiv.style.display = 'none';
                                uploadBtn.disabled = false;
                                uploadBtn.innerHTML = '<i class="fas fa-upload"></i> ফাইল আপলোড করুন';
                            });
                    });
                }
            );
        }

        // ✅ Load Files (updated to use new delete function)
        function loadFiles() {
            if (!db) return;
            
            const loading = document.getElementById('filesLoading');
            loading.style.display = 'block';
            
            db.ref('files').orderByChild('timestamp').once('value')
                .then((snapshot) => {
                    loading.style.display = 'none';
                    
                    if (!snapshot.exists()) {
                        document.getElementById('filesDisplay').innerHTML = `
                            <div class="empty-state">
                                <div class="empty-icon">
                                    <i class="fas fa-folder-open"></i>
                                </div>
                                <h3 style="margin-bottom: 12px;">কোনো ফাইল নেই</h3>
                                <p style="color: var(--gray);">প্রথম ফাইল আপলোড করুন</p>
                            </div>
                        `;
                        updateFileStats(0, 0, 0, 0);
                        return;
                    }
                    
                    currentFiles = [];
                    let html = `
                        <div class="table-container">
                            <table class="table">
                                <thead>
                                    <tr>
                                        <th>#</th>
                                        <th>ফাইল নাম</th>
                                        <th>ক্লাস</th>
                                        <th>বিষয়</th>
                                        <th>সাইজ</th>
                                        <th>তারিখ</th>
                                        <th>অ্যাকশন</th>
                                    </tr>
                                </thead>
                                <tbody>`;
                    
                    let index = 1;
                    let totalSize = 0;
                    let pdfCount = 0;
                    let imageCount = 0;
                    
                    snapshot.forEach((child) => {
                        const val = child.val();
                        const key = child.key;
                        
                        currentFiles.push({key, ...val});
                        totalSize += val.size || 0;
                        if (val.type === 'pdf') pdfCount++;
                        if (val.type === 'image') imageCount++;
                        
                        html += `
                            <tr>
                                <td>${index}</td>
                                <td>
                                    <strong>${val.fileName}</strong>
                                    <br>
                                    <small style="color: var(--gray); font-size: 12px;">${val.originalName}</small>
                                </td>
                                <td><span class="badge badge-primary">${val.class}</span></td>
                                <td>${getSubjectName(val.subject)}</td>
                                <td><small>${formatFileSize(val.size)}</small></td>
                                <td><small>${val.uploadDate}</small></td>
                                <td>
                                    <div class="action-group">
                                        <button onclick="viewFile('${key}')" class="action-btn action-view" title="দেখুন">
                                            <i class="fas fa-eye"></i>
                                        </button>
                                        <button onclick="downloadFile('${key}')" class="action-btn action-view" title="ডাউনলোড">
                                            <i class="fas fa-download"></i>
                                        </button>
                                        <button onclick="showDeleteConfirmation('${key}', 'file')" class="action-btn action-delete" title="ডিলিট">
                                            <i class="fas fa-trash"></i>
                                        </button>
                                    </div>
                                </td>
                            </tr>`;
                        index++;
                    });
                    
                    html += `</tbody></table></div>`;
                    document.getElementById('filesDisplay').innerHTML = html;
                    updateFileStats(index-1, totalSize, pdfCount, imageCount);
                    
                    // Setup file search
                    setupFileSearch();
                })
                .catch((error) => {
                    loading.style.display = 'none';
                    showToast("ফাইল লোড ব্যর্থ", "error");
                    console.error("Load files error:", error);
                });
        }

        // ✅ Setup File Search (same as before)
        function setupFileSearch() {
            const fileSearch = document.getElementById('fileSearch');
            const fileTypeFilter = document.getElementById('fileTypeFilter');
            
            const filterFiles = () => {
                const searchTerm = fileSearch.value.toLowerCase();
                const typeFilter = fileTypeFilter.value;
                
                const filteredFiles = currentFiles.filter(file => {
                    const matchesSearch = !searchTerm || 
                        (file.fileName && file.fileName.toLowerCase().includes(searchTerm)) ||
                        (file.originalName && file.originalName.toLowerCase().includes(searchTerm));
                    
                    const matchesType = !typeFilter || file.type === typeFilter;
                    
                    return matchesSearch && matchesType;
                });
                
                renderFilteredFiles(filteredFiles);
            };
            
            fileSearch.addEventListener('input', debounce(filterFiles, 300));
            fileTypeFilter.addEventListener('change', filterFiles);
        }

        // ✅ Render filtered files (updated to use new delete function)
        function renderFilteredFiles(filteredFiles) {
            if (filteredFiles.length === 0) {
                document.getElementById('filesDisplay').innerHTML = `
                    <div class="empty-state">
                        <div class="empty-icon">
                            <i class="fas fa-search"></i>
                        </div>
                        <h3 style="margin-bottom: 12px;">কোনো ফলাফল নেই</h3>
                        <p style="color: var(--gray);">অনুযায়ী কোনো ফাইল পাওয়া যায়নি</p>
                    </div>
                `;
                return;
            }
            
            let html = `
                <div class="table-container">
                    <table class="table">
                        <thead>
                            <tr>
                                <th>#</th>
                                <th>ফাইল নাম</th>
                                <th>ক্লাস</th>
                                <th>বিষয়</th>
                                <th>সাইজ</th>
                                <th>তারিখ</th>
                                <th>অ্যাকশন</th>
                            </tr>
                        </thead>
                        <tbody>`;
            
            filteredFiles.forEach((file, index) => {
                html += `
                    <tr>
                        <td>${index + 1}</td>
                        <td>
                            <strong>${file.fileName}</strong>
                            <br>
                            <small style="color: var(--gray); font-size: 12px;">${file.originalName}</small>
                        </td>
                        <td><span class="badge badge-primary">${file.class}</span></td>
                        <td>${getSubjectName(file.subject)}</td>
                        <td><small>${formatFileSize(file.size)}</small></td>
                        <td><small>${file.uploadDate}</small></td>
                        <td>
                            <div class="action-group">
                                <button onclick="viewFile('${file.key}')" class="action-btn action-view" title="দেখুন">
                                    <i class="fas fa-eye"></i>
                                </button>
                                <button onclick="downloadFile('${file.key}')" class="action-btn action-view" title="ডাউনলোড">
                                    <i class="fas fa-download"></i>
                                </button>
                                <button onclick="showDeleteConfirmation('${file.key}', 'file')" class="action-btn action-delete" title="ডিলিট">
                                    <i class="fas fa-trash"></i>
                                </button>
                            </div>
                        </td>
                    </tr>`;
            });
            
            html += `</tbody></table></div>`;
            document.getElementById('filesDisplay').innerHTML = html;
        }

        // ✅ Refresh Files (same as before)
        function refreshFiles() {
            loadFiles();
            showToast("ফাইল লিস্ট রিফ্রেশ করা হয়েছে", "success");
        }

        // ✅ View File (same as before)
        function viewFile(key) {
            const file = currentFiles.find(f => f.key === key);
            if (!file) return;
            
            openModal(`
                <div class="modal-header">
                    <h2 class="modal-title">${file.fileName}</h2>
                    <button onclick="closeModal()" class="modal-close">×</button>
                </div>
                <div class="modal-body">
                    <div style="display: grid; gap: 16px;">
                        <div>
                            <h3 style="margin-bottom: 12px;">বিস্তারিত</h3>
                            <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 12px;">
                                <div>
                                    <small style="color: var(--gray);">ক্লাস</small>
                                    <div>${file.class}</div>
                                </div>
                                <div>
                                    <small style="color: var(--gray);">বিষয়</small>
                                    <div>${getSubjectName(file.subject)}</div>
                                </div>
                                <div>
                                    <small style="color: var(--gray);">সাইজ</small>
                                    <div>${formatFileSize(file.size)}</div>
                                </div>
                                <div>
                                    <small style="color: var(--gray);">তারিখ</small>
                                    <div>${file.uploadDate}</div>
                                </div>
                                <div>
                                    <small style="color: var(--gray);">টাইপ</small>
                                    <div><span class="badge badge-primary">${file.type}</span></div>
                                </div>
                                <div>
                                    <small style="color: var(--gray);">ডাউনলোড</small>
                                    <div>${file.downloadCount || 0}</div>
                                </div>
                            </div>
                        </div>
                        ${file.description ? `
                        <div>
                            <h3 style="margin-bottom: 12px;">বর্ণনা</h3>
                            <p style="color: var(--gray); line-height: 1.6;">${file.description}</p>
                        </div>` : ''}
                        ${file.tags && file.tags.length > 0 ? `
                        <div>
                            <h3 style="margin-bottom: 12px;">ট্যাগস</h3>
                            <div style="display: flex; flex-wrap: wrap; gap: 8px;">
                                ${file.tags.map(tag => `<span class="badge badge-primary">${tag}</span>`).join('')}
                            </div>
                        </div>` : ''}
                        <div>
                            <button onclick="downloadFile('${key}')" class="btn" style="width: 100%; margin-bottom: 12px;">
                                <i class="fas fa-download"></i> ফাইল ডাউনলোড করুন
                            </button>
                            <a href="${file.url}" target="_blank" class="btn btn-success" style="width: 100%;">
                                <i class="fas fa-external-link-alt"></i> ফাইল ওপেন করুন
                            </a>
                        </div>
                    </div>
                </div>
            `);
            
            // Increment view count
            db.ref('files/' + key).update({
                viewCount: (file.viewCount || 0) + 1
            });
        }

        // ✅ Download File (same as before)
        function downloadFile(key) {
            const file = currentFiles.find(f => f.key === key);
            if (!file) return;
            
            const link = document.createElement('a');
            link.href = file.url;
            link.download = file.fileName + '.' + file.originalName.split('.').pop();
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            
            // Increment download count
            db.ref('files/' + key).update({
                downloadCount: (file.downloadCount || 0) + 1
            });
            
            showToast("ফাইল ডাউনলোড শুরু হয়েছে", "success");
        }

        // ✅ Helper Functions
        function getSubjectName(subjectCode) {
            const subjects = {
                'math': 'গণিত',
                'english': 'ইংরেজি',
                'science': 'বিজ্ঞান',
                'ict': 'ICT',
                'agriculture': 'কৃষি'
            };
            return subjects[subjectCode] || subjectCode;
        }

        function updateCounts(total, links) {
            document.getElementById('dataCount').textContent = total;
            document.getElementById('totalFilesStat').textContent = total;
        }

        function updateFileStats(total, size, pdf, image) {
            document.getElementById('fileCount').textContent = total;
            document.getElementById('totalSizeStat').textContent = formatFileSize(size);
            document.getElementById('pdfFilesStat').textContent = pdf;
            document.getElementById('imageFilesStat').textContent = image;
        }

        function updateStats() {
            if (db && currentUser) {
                // Update time
                updateCurrentTime();
            }
        }

        function updateCurrentTime() {
            const now = new Date();
            const timeString = now.toLocaleTimeString('bn-BD', { 
                hour: '2-digit', 
                minute: '2-digit',
                hour12: false 
            });
            document.getElementById('currentTime').textContent = timeString;
        }

        function scrollToTop() {
            window.scrollTo({
                top: 0,
                behavior: 'smooth'
            });
        }

        function showError(message) {
            const errorDiv = document.getElementById('loginError');
            errorDiv.textContent = message;
            errorDiv.style.display = 'block';
            
            // Add shake animation
            errorDiv.style.animation = 'none';
            setTimeout(() => {
                errorDiv.style.animation = 'shake 0.5s ease';
            }, 10);
        }

        function showToast(message, type) {
            const toastContainer = document.getElementById('toastContainer');
            const toast = document.createElement('div');
            toast.className = `toast ${type}`;
            
            let icon = 'ℹ️';
            if (type === 'success') icon = '<i class="fas fa-check-circle"></i>';
            else if (type === 'error') icon = '<i class="fas fa-exclamation-circle"></i>';
            else if (type === 'warning') icon = '<i class="fas fa-exclamation-triangle"></i>';
            else icon = '<i class="fas fa-info-circle"></i>';
            
            toast.innerHTML = `
                <div style="font-size: 20px;">
                    ${icon}
                </div>
                <div>${message}</div>
            `;
            
            toastContainer.appendChild(toast);
            
            // Auto remove after 3 seconds
            setTimeout(() => {
                toast.style.animation = 'slideInRight 0.3s ease reverse';
                setTimeout(() => {
                    toast.remove();
                }, 300);
            }, 3000);
        }

        function openModal(content) {
            document.getElementById('modalContent').innerHTML = content;
            document.getElementById('modalOverlay').style.display = 'flex';
        }

        function closeModal() {
            document.getElementById('modalOverlay').style.display = 'none';
        }

        function checkAppInstalled() {
            const isStandalone = window.matchMedia('(display-mode: standalone)').matches;
            isAppInstalled = isStandalone || window.navigator.standalone;
            
            if (isAppInstalled) {
                showToast("অ্যাপ ইনস্টল করা আছে", "success");
                document.getElementById('pwaStatus').textContent = "ইনস্টল করা আছে";
                document.getElementById('pwaStatus').className = "badge badge-success";
            } else {
                showToast("ওয়েব মোডে আছেন", "info");
                document.getElementById('pwaStatus').textContent = "ইনস্টল করুন";
                document.getElementById('pwaStatus').className = "badge badge-warning";
            }
        }

        function clearCache() {
            if (confirm("সকল ক্যাশে ডেটা ক্লিয়ার করতে চান?")) {
                localStorage.clear();
                showToast("ক্যাশে ক্লিয়ার করা হয়েছে", "success");
            }
        }

        function exportData() {
            if (currentData.length === 0 && currentFiles.length === 0) {
                showToast("এক্সপোর্ট করার মতো কোনো ডেটা নেই", "warning");
                return;
            }
            
            const exportData = {
                materials: currentData,
                files: currentFiles.map(f => ({
                    fileName: f.fileName,
                    class: f.class,
                    subject: f.subject,
                    size: f.size,
                    uploadDate: f.uploadDate,
                    url: f.url
                })),
                exportDate: new Date().toISOString(),
                totalItems: currentData.length + currentFiles.length
            };
            
            const dataStr = JSON.stringify(exportData, null, 2);
            const dataUri = 'data:application/json;charset=utf-8,'+ encodeURIComponent(dataStr);
            
            const exportFileDefaultName = 'education_admin_export_' + new Date().getTime() + '.json';
            
            const linkElement = document.createElement('a');
            linkElement.setAttribute('href', dataUri);
            linkElement.setAttribute('download', exportFileDefaultName);
            linkElement.click();
            
            showToast("ডেটা এক্সপোর্ট করা হয়েছে", "success");
        }

        function showAbout() {
            openModal(`
                <div class="modal-header">
                    <h2 class="modal-title">শিক্ষা সহায়িকা এডমিন</h2>
                    <button onclick="closeModal()" class="modal-close">×</button>
                </div>
                <div class="modal-body">
                    <div style="text-align: center; margin-bottom: 24px;">
                        <div style="font-size: 64px; margin-bottom: 16px; color: var(--primary);">
                            <i class="fas fa-book-open"></i>
                        </div>
                        <h3 style="margin-bottom: 8px;">শিক্ষা সহায়িকা এডমিন</h3>
                        <p style="color: var(--gray);">ভার্সন 3.0.0</p>
                    </div>
                    <div style="background: rgba(0,0,0,0.02); padding: 20px; border-radius: 12px; margin-bottom: 20px;">
                        <p style="color: var(--gray); line-height: 1.6;">
                            একটি পূর্ণাঙ্গ শিক্ষা উপকরণ ব্যবস্থাপনা সিস্টেম। 
                            শিক্ষার্থীদের জন্য বই, গাইড, নোট, ভিডিও এবং প্রশ্নব্যাংক ব্যবস্থাপনা করুন।
                        </p>
                    </div>
                    <div style="display: grid; gap: 12px;">
                        <div style="display: flex; justify-content: space-between;">
                            <span>ডেভেলপার</span>
                            <span style="font-weight: 600;">মোঃ শাহীনুর আলম</span>
                        </div>
                        <div style="display: flex; justify-content: space-between;">
                            <span>কন্ট্যাক্ট</span>
                            <span style="font-weight: 600;">shahinuralam2017t@gmail.com</span>
                        </div>
                        <div style="display: flex; justify-content: space-between;">
                            <span>আপডেট</span>
                            <span style="font-weight: 600;">${new Date().toLocaleDateString('bn-BD')}</span>
                        </div>
                        <div style="display: flex; justify-content: space-between;">
                            <span>মোট কন্টেন্ট</span>
                            <span style="font-weight: 600;">${currentData.length}</span>
                        </div>
                        <div style="display: flex; justify-content: space-between;">
                            <span>মোট ফাইল</span>
                            <span style="font-weight: 600;">${currentFiles.length}</span>
                        </div>
                    </div>
                </div>
            `);
        }

        function showStats() {
            let totalFileSize = 0;
            currentFiles.forEach(file => {
                totalFileSize += file.size || 0;
            });
            
            const pdfCount = currentFiles.filter(f => f.type === 'pdf').length;
            const imageCount = currentFiles.filter(f => f.type === 'image').length;
            const videoCount = currentFiles.filter(f => f.type === 'video').length;
            
            openModal(`
                <div class="modal-header">
                    <h2 class="modal-title">স্ট্যাটিস্টিক্স</h2>
                    <button onclick="closeModal()" class="modal-close">×</button>
                </div>
                <div class="modal-body">
                    <div style="display: grid; gap: 24px;">
                        <div>
                            <h3 style="margin-bottom: 16px;">সারাংশ</h3>
                            <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 12px;">
                                <div style="background: rgba(0,0,0,0.02); padding: 16px; border-radius: 12px;">
                                    <div style="font-size: 24px; font-weight: 700; color: var(--primary);">${currentData.length}</div>
                                    <div style="font-size: 14px; color: var(--gray);">মোট কন্টেন্ট</div>
                                </div>
                                <div style="background: rgba(0,0,0,0.02); padding: 16px; border-radius: 12px;">
                                    <div style="font-size: 24px; font-weight: 700; color: var(--primary);">${currentFiles.length}</div>
                                    <div style="font-size: 14px; color: var(--gray);">মোট ফাইল</div>
                                </div>
                                <div style="background: rgba(0,0,0,0.02); padding: 16px; border-radius: 12px;">
                                    <div style="font-size: 24px; font-weight: 700; color: var(--primary);">${formatFileSize(totalFileSize)}</div>
                                    <div style="font-size: 14px; color: var(--gray);">মোট স্টোরেজ</div>
                                </div>
                                <div style="background: rgba(0,0,0,0.02); padding: 16px; border-radius: 12px;">
                                    <div style="font-size: 24px; font-weight: 700; color: var(--primary);">${pdfCount}</div>
                                    <div style="font-size: 14px; color: var(--gray);">PDF ফাইল</div>
                                </div>
                            </div>
                        </div>
                        
                        <div>
                            <h3 style="margin-bottom: 16px;">ফাইল টাইপ</h3>
                            <div style="background: rgba(0,0,0,0.02); padding: 20px; border-radius: 12px;">
                                <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                                    <span>PDF</span>
                                    <span>${pdfCount}</span>
                                </div>
                                <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                                    <span>ছবি</span>
                                    <span>${imageCount}</span>
                                </div>
                                <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                                    <span>ভিডিও</span>
                                    <span>${videoCount}</span>
                                </div>
                                <div style="display: flex; justify-content: space-between;">
                                    <span>অন্যান্য</span>
                                    <span>${currentFiles.length - pdfCount - imageCount - videoCount}</span>
                                </div>
                            </div>
                        </div>
                        
                        <div>
                            <h3 style="margin-bottom: 16px;">সিস্টেম তথ্য</h3>
                            <div style="background: rgba(0,0,0,0.02); padding: 20px; border-radius: 12px;">
                                <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                                    <span>ইউজার</span>
                                    <span>${currentUser?.email || 'N/A'}</span>
                                </div>
                                <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                                    <span>অনলাইন স্ট্যাটাস</span>
                                    <span>${navigator.onLine ? '🟢 অনলাইন' : '🔴 অফলাইন'}</span>
                                </div>
                                <div style="display: flex; justify-content: space-between;">
                                    <span>বর্তমান সময়</span>
                                    <span>${new Date().toLocaleTimeString('bn-BD')}</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            `);
        }

        // ✅ Event Listeners
        document.addEventListener('DOMContentLoaded', function() {
            initializeFirebase();
            
            // Drag and drop for file upload
            const dropArea = document.getElementById('dropArea');
            
            ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
                dropArea.addEventListener(eventName, preventDefaults, false);
            });
            
            function preventDefaults(e) {
                e.preventDefault();
                e.stopPropagation();
            }
            
            ['dragenter', 'dragover'].forEach(eventName => {
                dropArea.addEventListener(eventName, highlight, false);
            });
            
            ['dragleave', 'drop'].forEach(eventName => {
                dropArea.addEventListener(eventName, unhighlight, false);
            });
            
            function highlight() {
                dropArea.classList.add('dragover');
            }
            
            function unhighlight() {
                dropArea.classList.remove('dragover');
            }
            
            dropArea.addEventListener('drop', handleDrop, false);
            
            function handleDrop(e) {
                const dt = e.dataTransfer;
                const files = dt.files;
                
                selectedFiles = Array.from(files);
                displayFilePreview();
            }
            
            // Network status
            function updateOnlineStatus() {
                const statusDot = document.getElementById('statusDot');
                const statusText = document.getElementById('statusText');
                
                if (navigator.onLine) {
                    statusDot.style.background = 'var(--secondary)';
                    statusText.textContent = 'অনলাইন';
                    statusDot.classList.remove('offline');
                } else {
                    statusDot.style.background = 'var(--danger)';
                    statusText.textContent = 'অফলাইন';
                    statusDot.classList.add('offline');
                }
            }
            
            window.addEventListener('online', updateOnlineStatus);
            window.addEventListener('offline', updateOnlineStatus);
            updateOnlineStatus();
            
            // Handle Enter key in login
            document.getElementById('adminPassword').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    loginAdmin();
                }
            });
            
            // Initialize time
            updateCurrentTime();
            
            // Close delete modal when clicking outside
            document.getElementById('deleteModal').addEventListener('click', function(e) {
                if (e.target === this) {
                    closeDeleteModal();
                }
            });
        });

        // ✅ Before Install Prompt
        window.addEventListener('beforeinstallprompt', (e) => {
            e.preventDefault();
            deferredPrompt = e;
            
            // Show install button after 5 seconds
            setTimeout(() => {
                if (deferredPrompt && !isAppInstalled) {
                    const installBtn = document.createElement('button');
                    installBtn.innerHTML = '<i class="fas fa-mobile-alt"></i> অ্যাপ ইনস্টল করুন';
                    installBtn.style.cssText = `
                        position: fixed;
                        bottom: 100px;
                        right: 32px;
                        background: linear-gradient(135deg, var(--primary), var(--primary-dark));
                        color: white;
                        border: none;
                        padding: 12px 24px;
                        border-radius: 50px;
                        cursor: pointer;
                        font-weight: 600;
                        box-shadow: 0 10px 30px rgba(79, 70, 229, 0.4);
                        z-index: 999;
                        animation: slideInRight 0.3s ease;
                        display: flex;
                        align-items: center;
                        gap: 8px;
                    `;
                    installBtn.onclick = () => {
                        deferredPrompt.prompt();
                        deferredPrompt.userChoice.then((choiceResult) => {
                            if (choiceResult.outcome === 'accepted') {
                                showToast('অ্যাপ ইনস্টলেশন শুরু হয়েছে!', 'success');
                            }
                            deferredPrompt = null;
                            installBtn.remove();
                        });
                    };
                    document.body.appendChild(installBtn);
                    
                    setTimeout(() => {
                        if (installBtn.parentNode) {
                            installBtn.remove();
                        }
                    }, 10000);
                }
            }, 5000);
        });

        // ✅ App Installed Event
        window.addEventListener('appinstalled', () => {
            isAppInstalled = true;
            deferredPrompt = null;
            showToast("অ্যাপ সফলভাবে ইনস্টল হয়েছে!", "success");
        });
    </script>
</body>
</html>
